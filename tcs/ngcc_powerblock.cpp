#include "sam_csp_util.h"
#include "ngcc_powerblock.h"

void ngcc_power_cycle::set_cycle1_table_props()
{
	// Spacing for each NGCC independent variable
	m_delta_P	= -0.05;
	m_delta_q = 20.0;
	m_delta_T = 5.0;
	// Number of points for each NGCC independent variable
	m_N_P = 6;
	m_N_q = 11;
	m_N_T = 8;
	// Starting value for each NGCC independent variables
	m_P_amb_start = 1.01325;		//[bar]
	m_q_sf_start  = 0.0;			//[MWt]
	m_T_amb_start = 0.0;			//[C]
	// Ending value for each NGCC independent variables
	m_P_amb_end = m_P_amb_start + m_delta_P*(m_N_P - 1.0);
	m_T_amb_end = m_T_amb_start + m_delta_T*(m_N_T - 1.0);
	m_q_sf_end = m_q_sf_start + m_delta_q*(m_N_q - 1.0);

	const double solar_steam_mass[6][11][8] =   // Soar Steam Mass Flow Rate (kg/s)
	{   // blocks for constant ambient pressure
	    // rows for constant solar heat
	    // columns for constant ambient temperature
	    //    
	    //Ambient P (bar)     Mininum     d_spacing       Max           n      
	    //                 1.01325        -0.05      0.76325            6
	    //    
	    //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
	    //                    0.00        20.00       200.00           11
	    //    
	    //Ambient T (C)       Mininum     d_spacing       Max           n      
	    //                    0.00         5.00        35.00            8
	    //    
	        {  // amibent pressure =  1.01325 bar
	          {  0.0000,  -0.0000,  -0.0000,  -0.0000,   0.0000,  -0.0000,  -0.0000,   0.0000}, 
	          {  6.2151,   6.2107,   6.2055,   6.1995,   6.1892,   6.1775,   6.1648,   6.1451}, 
	          { 12.4472,  12.4366,  12.4244,  12.4106,  12.3880,  12.3626,  12.3351,  12.2933}, 
	          { 18.6867,  18.6677,  18.6463,  18.6228,  18.5855,  18.5439,  18.4992,  18.4326}, 
	          { 24.9500,  24.8961,  24.8652,  24.8297,  24.7754,  24.7152,  24.6509,  24.5567}, 
	          { 31.2447,  31.1736,  31.1007,  31.0313,  30.9576,  30.8765,  30.7905,  30.6662}, 
	          { 37.5554,  37.4668,  37.3756,  37.2812,  37.1558,  37.0287,  36.9192,  36.7627}, 
	          { 43.8814,  43.7744,  43.6645,  43.5502,  43.3988,  43.2393,  43.0755,  42.8595}, 
	          { 50.2231,  50.0973,  49.9681,  49.8331,  49.6599,  49.4803,  49.2854,  49.0243}, 
	          { 56.5889,  56.4543,  56.3031,  56.1442,  55.9351,  55.7173,  55.4938,  55.1931}, 
	          { 62.9715,  62.8054,  62.6356,  62.4574,  62.2198,  61.9703,  61.7165,  61.3763}
	          }, 
	        {  // amibent pressure =  0.96325 bar
	          {  0.0000,  -0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000}, 
	          {  6.1489,   6.1449,   6.1400,   6.1343,   6.1246,   6.1136,   6.1015,   6.0827}, 
	          { 12.3133,  12.3033,  12.2917,  12.2786,  12.2572,  12.2330,  12.2069,  12.1669}, 
	          { 18.4830,  18.4648,  18.4444,  18.4218,  18.3864,  18.3466,  18.3039,  18.2399}, 
	          { 24.6738,  24.6214,  24.5918,  24.5577,  24.5067,  24.4488,  24.3872,  24.2963}, 
	          { 30.8936,  30.8251,  30.7543,  30.6863,  30.6156,  30.5374,  30.4545,  30.3345}, 
	          { 37.1273,  37.0416,  36.9533,  36.8626,  36.7422,  36.6142,  36.5102,  36.3586}, 
	          { 43.3743,  43.2714,  43.1642,  43.0544,  42.9089,  42.7545,  42.6012,  42.3934}, 
	          { 49.6347,  49.5129,  49.3939,  49.2633,  49.0995,  48.9162,  48.7276,  48.4743}, 
	          { 55.9266,  55.7838,  55.6386,  55.4867,  55.2858,  55.0738,  54.8563,  54.5657}, 
	          { 62.2137,  62.0531,  61.8891,  61.7162,  61.4879,  61.2472,  61.0016,  60.6730}
	          }, 
	        {  // amibent pressure =  0.91325 bar
	          {  0.0000,   0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,   0.0000,   0.0000}, 
	          {  6.0826,   6.0788,   6.0743,   6.0689,   6.0598,   6.0494,   6.0379,   6.0201}, 
	          { 12.1788,  12.1694,  12.1584,  12.1461,  12.1259,  12.1029,  12.0780,  12.0399}, 
	          { 18.2783,  18.2609,  18.2414,  18.2199,  18.1862,  18.1483,  18.1073,  18.0461}, 
	          { 24.3973,  24.3466,  24.3176,  24.2849,  24.2354,  24.1799,  24.1204,  24.0333}, 
	          { 30.5414,  30.4749,  30.4065,  30.3389,  30.2712,  30.1960,  30.1169,  30.0012}, 
	          { 36.6978,  36.6147,  36.5293,  36.4418,  36.3261,  36.2025,  36.0976,  35.9515}, 
	          { 42.8651,  42.7647,  42.6625,  42.5565,  42.4169,  42.2716,  42.1248,  41.9166}, 
	          { 49.0439,  48.9323,  48.8205,  48.6939,  48.5270,  48.3488,  48.1657,  47.9217}, 
	          { 55.2484,  55.1107,  54.9700,  54.8254,  54.6330,  54.4280,  54.2179,  53.9379}, 
	          { 61.4513,  61.2977,  61.1387,  60.9733,  60.7562,  60.5237,  60.2851,  59.9683}
	          }, 
	        {  // amibent pressure =  0.86325 bar
	          {  0.0000,  -0.0000,  -0.0000,  -0.0000,   0.0000,   0.0000,  -0.0000,   0.0000}, 
	          {  6.0160,   6.0125,   6.0082,   6.0032,   5.9947,   5.9849,   5.9740,   5.9571}, 
	          { 12.0437,  12.0348,  12.0245,  12.0128,  11.9938,  11.9722,  11.9483,  11.9120}, 
	          { 18.0723,  18.0557,  18.0371,  18.0166,  17.9847,  17.9486,  17.9096,  17.8509}, 
	          { 24.1185,  24.0695,  24.0406,  24.0093,  23.9620,  23.9093,  23.8518,  23.7683}, 
	          { 30.1882,  30.1238,  30.0577,  29.9899,  29.9249,  29.8527,  29.7753,  29.6643}, 
	          { 36.2656,  36.1851,  36.1031,  36.0182,  35.9072,  35.7882,  35.6816,  35.5405}, 
	          { 42.3527,  42.2557,  42.1562,  42.0547,  41.9246,  41.7873,  41.6363,  41.4357}, 
	          { 48.4551,  48.3492,  48.2306,  48.1098,  47.9492,  47.7775,  47.6006,  47.3644}, 
	          { 54.5665,  54.4348,  54.2995,  54.1607,  53.9759,  53.7786,  53.5748,  53.3047}, 
	          { 60.6854,  60.5365,  60.3845,  60.2282,  60.0194,  59.7946,  59.5632,  59.2576}
	          }, 
	        {  // amibent pressure =  0.81325 bar
	          { -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000}, 
	          {  5.9489,   5.9457,   5.9417,   5.9370,   5.9290,   5.9199,   5.9096,   5.8936}, 
	          { 11.9076,  11.8993,  11.8895,  11.8786,  11.8606,  11.8404,  11.8177,  11.7831}, 
	          { 17.8649,  17.8491,  17.8313,  17.8117,  17.7815,  17.7473,  17.7098,  17.6537}, 
	          { 23.8379,  23.7905,  23.7612,  23.7311,  23.6862,  23.6356,  23.5807,  23.5000}, 
	          { 29.8312,  29.7689,  29.7051,  29.6397,  29.5745,  29.5052,  29.4307,  29.3232}, 
	          { 35.8312,  35.7534,  35.6737,  35.5923,  35.4860,  35.3717,  35.2658,  35.1294}, 
	          { 41.8362,  41.7424,  41.6506,  41.5520,  41.4300,  41.2896,  41.1446,  40.9500}, 
	          { 47.8621,  47.7502,  47.6355,  47.5194,  47.3665,  47.2012,  47.0302,  46.8039}, 
	          { 53.8803,  53.7526,  53.6225,  53.4895,  53.3142,  53.1230,  52.9261,  52.6662}, 
	          { 59.9138,  59.7716,  59.6255,  59.4762,  59.2771,  59.0603,  58.8358,  58.5412}
	          }, 
	        {  // amibent pressure =  0.76325 bar
	          { -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000,  -0.0000}, 
	          {  5.8813,   5.8783,   5.8747,   5.8704,   5.8629,   5.8545,   5.8448,   5.8296}, 
	          { 11.7704,  11.7626,  11.7535,  11.7431,  11.7262,  11.7072,  11.6857,  11.6528}, 
	          { 17.6552,  17.6401,  17.6232,  17.6046,  17.5760,  17.5439,  17.5079,  17.4543}, 
	          { 23.5548,  23.5090,  23.4786,  23.4497,  23.4069,  23.3589,  23.3061,  23.2286}, 
	          { 29.4708,  29.4107,  29.3491,  29.2865,  29.2191,  29.1528,  29.0812,  28.9774}, 
	          { 35.3910,  35.3159,  35.2390,  35.1606,  35.0591,  34.9525,  34.8387,  34.7117}, 
	          { 41.3185,  41.2272,  41.1435,  41.0472,  40.9227,  40.7881,  40.6482,  40.4610}, 
	          { 47.2526,  47.1444,  47.0347,  46.9233,  46.7779,  46.6195,  46.4546,  46.2366}, 
	          { 53.1872,  53.0634,  52.9379,  52.8119,  52.6447,  52.4614,  52.2718,  52.0199}, 
	          { 59.1357,  58.9979,  58.8576,  58.7149,  58.5254,  58.3169,  58.1000,  57.8176}
	          }
	}; // end of data.       
	// block_t syntax: ( solar heat, ambient temp, pressure )
	m_solar_steam_mass.assign( solar_steam_mass[0][0], 11, 8, 6 );

	const double solar_extraction_p[6][11][8] =   // Soar Extraction Steam Pressure (bar)
    {   // blocks for constant ambient pressure
        // rows for constant solar heat
        // columns for constant ambient temperature
        //    
        //Ambient P (bar)     Mininum     d_spacing       Max           n      
        //                 1.01325        -0.05      0.76325            6
        //    
        //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
        //                    0.00        20.00       200.00           11
        //    
        //Ambient T (C)       Mininum     d_spacing       Max           n      
        //                    0.00         5.00        35.00            8
        //    
            {  // amibent pressure =  1.01325 bar
                { 76.6571,  76.4179,  76.1507,  75.8574,  75.3599,  74.8291,  74.2665,  73.3576}, 
                { 81.4077,  81.1732,  80.9098,  80.6199,  80.1265,  79.5940,  79.0303,  78.1191}, 
                { 86.1980,  85.9665,  85.7059,  85.4178,  84.9218,  84.3886,  83.8223,  82.9043}, 
                { 91.0225,  90.7931,  90.5333,  90.2463,  89.7481,  89.2112,  88.6405,  87.7150}, 
                { 95.8270,  95.6649,  95.3986,  95.1096,  94.6083,  94.0661,  93.4894,  92.5547}, 
                {100.6181, 100.4545, 100.2576, 100.0125,  99.5056,  98.9568,  98.3731,  97.4277}, 
                {105.4376, 105.2740, 105.0755, 104.8434, 104.3942, 103.8871, 103.2952, 102.3382}, 
                {110.2844, 110.1204, 109.9215, 109.6874, 109.2345, 108.7333, 108.1912, 107.2897}, 
                {115.1580, 114.9940, 114.7947, 114.5588, 114.1089, 113.6135, 113.0631, 112.1440}, 
                {120.0671, 119.9159, 119.7137, 119.4730, 119.0088, 118.4969, 117.9418, 117.0148}, 
                {124.9993, 124.8344, 124.6341, 124.3951, 123.9276, 123.4089, 122.8499, 121.9164}
                }, 
            {  // amibent pressure =  0.96325 bar
                { 73.1367,  72.9063,  72.6491,  72.3676,  71.8923,  71.3847,  70.8510,  69.9822}, 
                { 77.8552,  77.6297,  77.3774,  77.1018,  76.6285,  76.1213,  75.5870,  74.7148}, 
                { 82.6137,  82.3914,  82.1415,  81.8657,  81.3923,  80.8836,  80.3471,  79.4697}, 
                { 87.4072,  87.1861,  86.9371,  86.6616,  86.1863,  85.6743,  85.1334,  84.2490}, 
                { 92.1847,  92.0235,  91.7691,  91.4925,  91.0137,  90.4965,  89.9500,  89.0564}, 
                { 96.9521,  96.7907,  96.5967,  96.3622,  95.8782,  95.3544,  94.8006,  93.8968}, 
                {101.7491, 101.5870, 101.3922, 101.1664, 100.7340, 100.2558,  99.6901,  98.7746}, 
                {106.5741, 106.4124, 106.2157, 105.9881, 105.5519, 105.0689, 104.5581, 103.6933}, 
                {111.4257, 111.2629, 111.0749, 110.8444, 110.4142, 109.9245, 109.3981, 108.5138}, 
                {116.3237, 116.1584, 115.9610, 115.7280, 115.2812, 114.7862, 114.2535, 113.3626}, 
                {121.2218, 121.0584, 120.8618, 120.6275, 120.1774, 119.6783, 119.1432, 118.2458}
                }, 
            {  // amibent pressure =  0.91325 bar
                { 69.6035,  69.3823,  69.1357,  68.8664,  68.4130,  67.9295,  67.4191,  66.5945}, 
                { 74.2902,  74.0762,  73.8347,  73.5695,  73.1185,  72.6360,  72.1254,  71.2996}, 
                { 79.0162,  78.8032,  78.5643,  78.3012,  77.8506,  77.3660,  76.8545,  76.0239}, 
                { 83.7769,  83.5651,  83.3270,  83.0643,  82.6119,  82.1252,  81.6087,  80.7714}, 
                { 88.5269,  88.3675,  88.1258,  87.8621,  87.4064,  86.9146,  86.3925,  85.5464}, 
                { 93.2719,  93.1118,  92.9216,  92.6982,  92.2377,  91.7394,  91.2103,  90.3541}, 
                { 98.0463,  97.8856,  97.6945,  97.4749,  97.0592,  96.6003,  96.0666,  95.1991}, 
                {102.8485, 102.6874, 102.4967, 102.2752, 101.8561, 101.3977, 100.9077, 100.0734}, 
                {107.6778, 107.5250, 107.3444, 107.1196, 106.6938, 106.2219, 105.7139, 104.8720}, 
                {112.5492, 112.3861, 112.1921, 111.9680, 111.5391, 111.0632, 110.5504, 109.7019}, 
                {117.4272, 117.2674, 117.0739, 116.8477, 116.4176, 115.9377, 115.4207, 114.5657}
                }, 
            {  // amibent pressure =  0.86325 bar
                { 66.0548,  65.8422,  65.6068,  65.3500,  64.9187,  64.4598,  63.9756,  63.1959}, 
                { 70.7128,  70.5063,  70.2760,  70.0236,  69.5954,  69.1376,  68.6539,  67.8722}, 
                { 75.4040,  75.2006,  74.9730,  74.7229,  74.2953,  73.8375,  73.3516,  72.5656}, 
                { 80.1316,  79.9294,  79.7025,  79.4527,  79.0239,  78.5625,  78.0740,  77.2814}, 
                { 84.8531,  84.6960,  84.4680,  84.2171,  83.7850,  83.3195,  82.8242,  82.0238}, 
                { 89.5751,  89.4171,  89.2313,  89.0194,  88.5831,  88.1107,  87.6090,  86.7987}, 
                { 94.3265,  94.1680,  93.9820,  93.7682,  93.3695,  92.9308,  92.4324,  91.6102}, 
                { 99.1061,  98.9473,  98.7599,  98.5460,  98.1498,  97.7146,  97.2337,  96.4397}, 
                {103.9205, 103.7717, 103.5816, 103.3650, 102.9564, 102.5048, 102.0192, 101.2163}, 
                {108.7583, 108.5991, 108.4101, 108.1932, 107.7821, 107.3267, 106.8353, 106.0270}, 
                {113.6165, 113.4582, 113.2708, 113.0548, 112.6420, 112.1815, 111.6859, 110.8711}
                }, 
            {  // amibent pressure =  0.81325 bar
                { 62.4911,  62.2888,  62.0647,  61.8207,  61.4120,  60.9779,  60.5208,  59.7851}, 
                { 67.1175,  66.9199,  66.7002,  66.4612,  66.0559,  65.6237,  65.1675,  64.4297}, 
                { 71.7754,  71.5820,  71.3660,  71.1293,  70.7250,  70.2928,  69.8354,  69.0937}, 
                { 76.4702,  76.2778,  76.0624,  75.8255,  75.4202,  74.9850,  74.5238,  73.7760}, 
                { 81.1620,  81.0076,  80.7939,  80.5561,  80.1479,  79.7080,  79.2415,  78.4852}, 
                { 85.8606,  85.7053,  85.5243,  85.3194,  84.9132,  84.4671,  83.9937,  83.2277}, 
                { 90.5889,  90.4330,  90.2511,  90.0451,  89.6648,  89.2463,  88.7889,  88.0119}, 
                { 95.3456,  95.1894,  95.0126,  94.8048,  94.4298,  94.0035,  93.5469,  92.7913}, 
                {100.1451,  99.9866,  99.8012,  99.5921,  99.2033,  98.7723,  98.3095,  97.5489}, 
                {104.9503, 104.7931, 104.6095, 104.4004, 104.0098, 103.5730, 103.1054, 102.3382}, 
                {109.7878, 109.6338, 109.4517, 109.2439, 108.8508, 108.4106, 107.9371, 107.1627}
                }, 
            {  // amibent pressure =  0.76325 bar
                { 58.9113,  58.7199,  58.5067,  58.2758,  57.8900,  57.4811,  57.0514,  56.3592}, 
                { 63.5027,  63.3165,  63.1096,  62.8835,  62.5020,  62.0958,  61.6677,  60.9741}, 
                { 68.1290,  67.9462,  67.7421,  67.5187,  67.1377,  66.7317,  66.3014,  65.6049}, 
                { 72.7896,  72.6074,  72.4038,  72.1807,  71.7991,  71.3910,  70.9577,  70.2556}, 
                { 77.4521,  77.3009,  77.1017,  76.8774,  76.4931,  76.0798,  75.6416,  74.9309}, 
                { 82.1269,  81.9748,  81.7992,  81.6023,  81.2245,  80.8050,  80.3605,  79.6395}, 
                { 86.8317,  86.6791,  86.5025,  86.3041,  85.9425,  85.5498,  85.1212,  84.3964}, 
                { 91.5709,  91.4170,  91.2497,  91.0478,  90.6806,  90.2762,  89.8429,  89.1291}, 
                { 96.3370,  96.1817,  96.0029,  95.8018,  95.4330,  95.0239,  94.5850,  93.8655}, 
                {101.1223, 100.9677, 100.7892, 100.5902, 100.2193,  99.8043,  99.3610,  98.6331}, 
                {105.9402, 105.7885, 105.6121, 105.4129, 105.0398, 104.6211, 104.1706, 103.4391}
                }
    }; // end of data.    
    m_solar_extraction_p.assign( solar_extraction_p[0][0], 11, 8, 6 );

	const double solar_injection_p[6][11][8] =   // Soar Injection Steam Pressure (bar)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  { 76.6571,  76.4179,  76.1507,  75.8574,  75.3599,  74.8291,  74.2665,  73.3576}, 
                  { 81.4077,  81.1732,  80.9098,  80.6199,  80.1265,  79.5940,  79.0303,  78.1191}, 
                  { 86.1980,  85.9665,  85.7059,  85.4178,  84.9218,  84.3886,  83.8223,  82.9043}, 
                  { 91.0225,  90.7931,  90.5333,  90.2463,  89.7481,  89.2112,  88.6405,  87.7150}, 
                  { 95.8270,  95.6649,  95.3986,  95.1096,  94.6083,  94.0661,  93.4894,  92.5547}, 
                  {100.6181, 100.4545, 100.2576, 100.0125,  99.5056,  98.9568,  98.3731,  97.4277}, 
                  {105.4376, 105.2740, 105.0755, 104.8434, 104.3942, 103.8871, 103.2952, 102.3382}, 
                  {110.2844, 110.1204, 109.9215, 109.6874, 109.2345, 108.7333, 108.1912, 107.2897}, 
                  {115.1580, 114.9940, 114.7947, 114.5588, 114.1089, 113.6135, 113.0631, 112.1440}, 
                  {120.0671, 119.9159, 119.7137, 119.4730, 119.0088, 118.4969, 117.9418, 117.0148}, 
                  {124.9993, 124.8344, 124.6341, 124.3951, 123.9276, 123.4089, 122.8499, 121.9164}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  { 73.1367,  72.9063,  72.6491,  72.3676,  71.8923,  71.3847,  70.8510,  69.9822}, 
                  { 77.8552,  77.6297,  77.3774,  77.1018,  76.6285,  76.1213,  75.5870,  74.7148}, 
                  { 82.6137,  82.3914,  82.1415,  81.8657,  81.3923,  80.8836,  80.3471,  79.4697}, 
                  { 87.4072,  87.1861,  86.9371,  86.6616,  86.1863,  85.6743,  85.1334,  84.2490}, 
                  { 92.1847,  92.0235,  91.7691,  91.4925,  91.0137,  90.4965,  89.9500,  89.0564}, 
                  { 96.9521,  96.7907,  96.5967,  96.3622,  95.8782,  95.3544,  94.8006,  93.8968}, 
                  {101.7491, 101.5870, 101.3922, 101.1664, 100.7340, 100.2558,  99.6901,  98.7746}, 
                  {106.5741, 106.4124, 106.2157, 105.9881, 105.5519, 105.0689, 104.5581, 103.6933}, 
                  {111.4257, 111.2629, 111.0749, 110.8444, 110.4142, 109.9245, 109.3981, 108.5138}, 
                  {116.3237, 116.1584, 115.9610, 115.7280, 115.2812, 114.7862, 114.2535, 113.3626}, 
                  {121.2218, 121.0584, 120.8618, 120.6275, 120.1774, 119.6783, 119.1432, 118.2458}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  { 69.6035,  69.3823,  69.1357,  68.8664,  68.4130,  67.9295,  67.4191,  66.5945}, 
                  { 74.2902,  74.0762,  73.8347,  73.5695,  73.1185,  72.6360,  72.1254,  71.2996}, 
                  { 79.0162,  78.8032,  78.5643,  78.3012,  77.8506,  77.3660,  76.8545,  76.0239}, 
                  { 83.7769,  83.5651,  83.3270,  83.0643,  82.6119,  82.1252,  81.6087,  80.7714}, 
                  { 88.5269,  88.3675,  88.1258,  87.8621,  87.4064,  86.9146,  86.3925,  85.5464}, 
                  { 93.2719,  93.1118,  92.9216,  92.6982,  92.2377,  91.7394,  91.2103,  90.3541}, 
                  { 98.0463,  97.8856,  97.6945,  97.4749,  97.0592,  96.6003,  96.0666,  95.1991}, 
                  {102.8485, 102.6874, 102.4967, 102.2752, 101.8561, 101.3977, 100.9077, 100.0734}, 
                  {107.6778, 107.5250, 107.3444, 107.1196, 106.6938, 106.2219, 105.7139, 104.8720}, 
                  {112.5492, 112.3861, 112.1921, 111.9680, 111.5391, 111.0632, 110.5504, 109.7019}, 
                  {117.4272, 117.2674, 117.0739, 116.8477, 116.4176, 115.9377, 115.4207, 114.5657}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  { 66.0548,  65.8422,  65.6068,  65.3500,  64.9187,  64.4598,  63.9756,  63.1959}, 
                  { 70.7128,  70.5063,  70.2760,  70.0236,  69.5954,  69.1376,  68.6539,  67.8722}, 
                  { 75.4040,  75.2006,  74.9730,  74.7229,  74.2953,  73.8375,  73.3516,  72.5656}, 
                  { 80.1316,  79.9294,  79.7025,  79.4527,  79.0239,  78.5625,  78.0740,  77.2814}, 
                  { 84.8531,  84.6960,  84.4680,  84.2171,  83.7850,  83.3195,  82.8242,  82.0238}, 
                  { 89.5751,  89.4171,  89.2313,  89.0194,  88.5831,  88.1107,  87.6090,  86.7987}, 
                  { 94.3265,  94.1680,  93.9820,  93.7682,  93.3695,  92.9308,  92.4324,  91.6102}, 
                  { 99.1061,  98.9473,  98.7599,  98.5460,  98.1498,  97.7146,  97.2337,  96.4397}, 
                  {103.9205, 103.7717, 103.5816, 103.3650, 102.9564, 102.5048, 102.0192, 101.2163}, 
                  {108.7583, 108.5991, 108.4101, 108.1932, 107.7821, 107.3267, 106.8353, 106.0270}, 
                  {113.6165, 113.4582, 113.2708, 113.0548, 112.6420, 112.1815, 111.6859, 110.8711}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  { 62.4911,  62.2888,  62.0647,  61.8207,  61.4120,  60.9779,  60.5208,  59.7851}, 
                  { 67.1175,  66.9199,  66.7002,  66.4612,  66.0559,  65.6237,  65.1675,  64.4297}, 
                  { 71.7754,  71.5820,  71.3660,  71.1293,  70.7250,  70.2928,  69.8354,  69.0937}, 
                  { 76.4702,  76.2778,  76.0624,  75.8255,  75.4202,  74.9850,  74.5238,  73.7760}, 
                  { 81.1620,  81.0076,  80.7939,  80.5561,  80.1479,  79.7080,  79.2415,  78.4852}, 
                  { 85.8606,  85.7053,  85.5243,  85.3194,  84.9132,  84.4671,  83.9937,  83.2277}, 
                  { 90.5889,  90.4330,  90.2511,  90.0451,  89.6648,  89.2463,  88.7889,  88.0119}, 
                  { 95.3456,  95.1894,  95.0126,  94.8048,  94.4298,  94.0035,  93.5469,  92.7913}, 
                  {100.1451,  99.9866,  99.8012,  99.5921,  99.2033,  98.7723,  98.3095,  97.5489}, 
                  {104.9503, 104.7931, 104.6095, 104.4004, 104.0098, 103.5730, 103.1054, 102.3382}, 
                  {109.7878, 109.6338, 109.4517, 109.2439, 108.8508, 108.4106, 107.9371, 107.1627}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  { 58.9113,  58.7199,  58.5067,  58.2758,  57.8900,  57.4811,  57.0514,  56.3592}, 
                  { 63.5027,  63.3165,  63.1096,  62.8835,  62.5020,  62.0958,  61.6677,  60.9741}, 
                  { 68.1290,  67.9462,  67.7421,  67.5187,  67.1377,  66.7317,  66.3014,  65.6049}, 
                  { 72.7896,  72.6074,  72.4038,  72.1807,  71.7991,  71.3910,  70.9577,  70.2556}, 
                  { 77.4521,  77.3009,  77.1017,  76.8774,  76.4931,  76.0798,  75.6416,  74.9309}, 
                  { 82.1269,  81.9748,  81.7992,  81.6023,  81.2245,  80.8050,  80.3605,  79.6395}, 
                  { 86.8317,  86.6791,  86.5025,  86.3041,  85.9425,  85.5498,  85.1212,  84.3964}, 
                  { 91.5709,  91.4170,  91.2497,  91.0478,  90.6806,  90.2762,  89.8429,  89.1291}, 
                  { 96.3370,  96.1817,  96.0029,  95.8018,  95.4330,  95.0239,  94.5850,  93.8655}, 
                  {101.1223, 100.9677, 100.7892, 100.5902, 100.2193,  99.8043,  99.3610,  98.6331}, 
                  {105.9402, 105.7885, 105.6121, 105.4129, 105.0398, 104.6211, 104.1706, 103.4391}
                  }
        }; // end of data.
        
        m_solar_injection_p.assign( solar_injection_p[0][0], 11, 8, 6 );

		const double solar_injection_t[6][11][8] =   // Soar Injection Steam Temperature (C)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {310.8030, 310.5878, 310.3470, 310.0818, 309.6302, 309.1458, 308.6296, 307.7892}, 
                  {314.9898, 314.7884, 314.5617, 314.3116, 313.8669, 313.4121, 312.9188, 312.1068}, 
                  {318.9930, 318.8028, 318.5881, 318.3501, 317.9390, 317.4951, 317.0212, 316.2478}, 
                  {322.8862, 322.6987, 322.4935, 322.2594, 321.8636, 321.4351, 320.9775, 320.2306}, 
                  {326.5883, 326.4655, 326.2635, 326.0437, 325.6554, 325.2399, 324.7959, 324.0719}, 
                  {330.1427, 330.0275, 329.8836, 329.7033, 329.3301, 328.9234, 328.4911, 327.7870}, 
                  {333.5943, 333.4791, 333.3406, 333.1754, 332.8605, 332.4998, 332.0753, 331.3889}, 
                  {336.9446, 336.8331, 336.6977, 336.5387, 336.2286, 335.8865, 335.5136, 334.8884}, 
                  {340.1984, 340.0908, 339.9598, 339.8045, 339.5076, 339.1801, 338.8140, 338.2003}, 
                  {343.3673, 343.2712, 343.1426, 342.9893, 342.6929, 342.3650, 342.0081, 341.4092}, 
                  {346.4576, 346.3560, 346.2325, 346.0779, 345.7887, 345.4668, 345.1188, 344.5376}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {307.5838, 307.3690, 307.1286, 306.8648, 306.4176, 305.9374, 305.4297, 304.5971}, 
                  {311.8908, 311.6905, 311.4657, 311.2016, 310.7773, 310.3204, 309.8366, 309.0412}, 
                  {316.0016, 315.8128, 315.6002, 315.3649, 314.9596, 314.5220, 314.0583, 313.2948}, 
                  {319.9808, 319.8010, 319.5980, 319.3730, 318.9834, 318.5620, 318.1147, 317.3785}, 
                  {323.7837, 323.6579, 323.4590, 323.2422, 322.8658, 322.4575, 322.0241, 321.3112}, 
                  {327.4334, 327.3096, 327.1637, 326.9871, 326.6215, 326.2242, 325.8024, 325.1098}, 
                  {330.9677, 330.8485, 330.7055, 330.5417, 330.2271, 329.8781, 329.4634, 328.7886}, 
                  {334.3915, 334.2775, 334.1424, 333.9820, 333.6747, 333.3346, 332.9737, 332.3594}, 
                  {337.7168, 337.6070, 337.4814, 337.3257, 337.0345, 336.6998, 336.3406, 335.7341}, 
                  {340.9603, 340.8526, 340.7249, 340.5718, 340.2792, 339.9541, 339.6040, 339.0134}, 
                  {344.0979, 343.9948, 343.8707, 343.7225, 343.4373, 343.1244, 342.7828, 342.2072}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {304.2317, 304.0175, 303.7781, 303.5160, 303.0729, 302.5979, 302.0937, 301.2879}, 
                  {308.6700, 308.4542, 308.2313, 307.9858, 307.5669, 307.1163, 306.6372, 305.8566}, 
                  {312.8976, 312.7105, 312.5001, 312.2679, 311.8688, 311.4466, 310.9801, 310.2324}, 
                  {316.9831, 316.8052, 316.6048, 316.3830, 316.0001, 315.5862, 315.1451, 314.4252}, 
                  {320.8861, 320.7578, 320.5628, 320.3496, 319.9801, 319.5797, 319.1526, 318.4564}, 
                  {324.6280, 324.5041, 324.3569, 324.1834, 323.8250, 323.4358, 323.0206, 322.3448}, 
                  {328.2483, 328.1287, 327.9863, 327.8223, 327.5111, 327.1664, 326.7640, 326.1061}, 
                  {331.7555, 331.6400, 331.5029, 331.3435, 331.0413, 330.7095, 330.3536, 329.7446}, 
                  {335.1591, 335.0515, 334.9263, 334.7702, 334.4739, 334.1444, 333.7885, 333.1956}, 
                  {338.4710, 338.3619, 338.2319, 338.0822, 337.7932, 337.4722, 337.1251, 336.5480}, 
                  {341.6791, 341.5735, 341.4502, 341.3035, 341.0214, 340.7087, 340.3707, 339.8090}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {300.7477, 300.5341, 300.2979, 300.0380, 299.6002, 299.1308, 298.6338, 297.8273}, 
                  {305.2978, 305.1003, 304.8796, 304.6369, 304.2239, 303.7800, 303.3086, 302.5415}, 
                  {309.6702, 309.4850, 309.2774, 309.0485, 308.6561, 308.2339, 307.7836, 307.0504}, 
                  {313.8714, 313.6956, 313.4980, 313.2799, 312.9043, 312.4985, 312.0668, 311.3621}, 
                  {317.8820, 317.7513, 317.5614, 317.3518, 316.9899, 316.5984, 316.1800, 315.4998}, 
                  {321.7257, 321.5997, 321.4512, 321.2815, 320.9313, 320.5506, 320.1446, 319.4851}, 
                  {325.4397, 325.3181, 325.1753, 325.0109, 324.7157, 324.3639, 323.9767, 323.3346}, 
                  {329.0336, 328.9163, 328.7778, 328.6194, 328.3253, 328.0013, 327.6419, 327.0455}, 
                  {332.5211, 332.4152, 332.2798, 332.1252, 331.8329, 331.5159, 331.1590, 330.5788}, 
                  {335.9022, 335.7928, 335.6628, 335.5133, 335.2294, 334.9179, 334.5767, 334.0128}, 
                  {339.1817, 339.0766, 338.9521, 338.8085, 338.5333, 338.2254, 337.8929, 337.3438}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {297.0914, 296.8789, 296.6431, 296.3854, 295.9521, 295.4893, 294.9994, 294.1995}, 
                  {301.7943, 301.6075, 301.3980, 301.1548, 300.7488, 300.3138, 299.8521, 299.1001}, 
                  {306.3072, 306.1244, 305.9197, 305.6948, 305.3095, 304.8956, 304.4555, 303.7374}, 
                  {310.6349, 310.4616, 310.2672, 310.0528, 309.6850, 309.2883, 308.8661, 308.1771}, 
                  {314.7617, 314.6288, 314.4446, 314.2392, 313.8855, 313.5027, 313.0951, 312.4304}, 
                  {318.7155, 318.5876, 318.4381, 318.2687, 317.9319, 317.5606, 317.1649, 316.5210}, 
                  {322.5306, 322.4073, 322.2632, 322.0997, 321.7972, 321.4631, 321.0967, 320.4708}, 
                  {326.2175, 326.0987, 325.9641, 325.8056, 325.5188, 325.1918, 324.8403, 324.2558}, 
                  {329.7971, 329.6810, 329.5539, 329.4004, 329.1052, 328.7869, 328.4440, 327.8826}, 
                  {333.2564, 333.1455, 333.0158, 332.8619, 332.5846, 332.2801, 331.9396, 331.3962}, 
                  {336.6066, 336.5039, 336.3797, 336.2351, 335.9685, 335.6631, 335.3401, 334.8042}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {293.2507, 293.0349, 292.8053, 292.5501, 292.1219, 291.6656, 291.1833, 290.4006}, 
                  {298.1441, 297.9508, 297.7355, 297.5019, 297.1027, 296.6758, 296.2198, 295.4852}, 
                  {302.7943, 302.6144, 302.4131, 302.1923, 301.8145, 301.4100, 300.9949, 300.2948}, 
                  {307.2600, 307.0896, 306.8988, 306.6892, 306.3296, 305.9433, 305.5315, 304.8599}, 
                  {311.5142, 311.3794, 311.2015, 311.0006, 310.6555, 310.2829, 309.8862, 309.2389}, 
                  {315.5877, 315.4580, 315.3080, 315.1396, 314.8155, 314.4542, 314.0699, 313.4430}, 
                  {319.5120, 319.3873, 319.2428, 319.0801, 318.7830, 318.4592, 318.1045, 317.5177}, 
                  {323.3037, 323.1830, 323.0516, 322.8994, 322.6031, 322.2831, 321.9460, 321.3694}, 
                  {326.9735, 326.8509, 326.7158, 326.5636, 326.2839, 325.9727, 325.6376, 325.0917}, 
                  {330.5097, 330.3972, 330.2756, 330.1306, 329.8599, 329.5517, 329.2305, 328.6934}, 
                  {333.9521, 333.8458, 333.7220, 333.5822, 333.3195, 333.0240, 332.6989, 332.1781}
                  }
        }; // end of data.
        
        m_solar_injection_t.assign( solar_injection_t[0][0], 11, 8, 6 );

		const double solar_extraction_t[6][11][8] =   // Soar Extraction Steam Temperature (C)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {281.1728, 281.0264, 280.8356, 280.6059, 280.1920, 279.7160, 279.1873, 278.3504}, 
                  {281.1834, 281.0027, 280.7801, 280.5223, 280.0676, 279.5635, 279.0017, 278.1241}, 
                  {280.8844, 280.6589, 280.3959, 280.0979, 279.6093, 279.0536, 278.4455, 277.5222}, 
                  {280.3911, 280.1097, 279.7989, 279.4500, 278.9096, 278.2982, 277.6365, 276.6518}, 
                  {280.0072, 279.3671, 279.0290, 278.6355, 278.0351, 277.3665, 276.6471, 275.5975}, 
                  {279.7084, 279.0378, 278.3468, 277.6932, 277.0403, 276.3122, 275.5376, 274.4223}, 
                  {279.3074, 278.6068, 277.8868, 277.1394, 276.1687, 275.1816, 274.3507, 273.1745}, 
                  {278.8188, 278.0936, 277.3485, 276.5742, 275.5670, 274.5012, 273.3975, 271.9594}, 
                  {278.2590, 277.5124, 276.7466, 275.9455, 274.9400, 273.8923, 272.7439, 271.2234}, 
                  {277.6799, 276.9697, 276.1731, 275.3353, 274.2542, 273.1221, 271.9527, 270.3974}, 
                  {277.0482, 276.2589, 275.4530, 274.5992, 273.4942, 272.3269, 271.1320, 269.5532}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {278.3311, 278.1898, 278.0029, 277.7783, 277.3743, 276.9050, 276.3856, 275.5546}, 
                  {278.3670, 278.1915, 277.9761, 277.7111, 277.2776, 276.7757, 276.2226, 275.3557}, 
                  {278.0731, 277.8513, 277.5925, 277.2982, 276.8190, 276.2688, 275.6687, 274.7483}, 
                  {277.5593, 277.2856, 276.9770, 276.6352, 276.1010, 275.4947, 274.8364, 273.8527}, 
                  {277.1636, 276.5216, 276.1845, 275.7917, 275.2002, 274.5330, 273.8163, 272.7630}, 
                  {276.8547, 276.1809, 275.4874, 274.8258, 274.1758, 273.4488, 272.6717, 271.5521}, 
                  {276.4366, 275.7345, 275.0123, 274.2711, 273.3042, 272.2684, 271.4529, 270.2682}, 
                  {275.9261, 275.2044, 274.4565, 273.6860, 272.6838, 271.6135, 270.5456, 269.1143}, 
                  {275.3457, 274.5989, 273.8718, 273.0712, 272.0877, 270.9748, 269.8231, 268.2928}, 
                  {274.7977, 274.0203, 273.2308, 272.4015, 271.3269, 270.1850, 269.0064, 267.4469}, 
                  {274.0828, 273.2948, 272.4907, 271.6417, 270.5429, 269.3815, 268.1826, 266.5972}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {275.3525, 275.2165, 275.0348, 274.8156, 274.4197, 273.9600, 273.4448, 272.6351}, 
                  {275.4174, 275.2344, 275.0246, 274.7782, 274.3547, 273.8622, 273.3136, 272.4569}, 
                  {275.1259, 274.9081, 274.6528, 274.3644, 273.8942, 273.3584, 272.7544, 271.8414}, 
                  {274.5995, 274.3275, 274.0209, 273.6817, 273.1542, 272.5537, 271.8968, 270.9169}, 
                  {274.1876, 273.5454, 273.2010, 272.8109, 272.2236, 271.5597, 270.8401, 269.7888}, 
                  {273.8617, 273.1883, 272.4952, 271.8125, 271.1656, 270.4390, 269.6574, 268.5352}, 
                  {273.4211, 272.7196, 271.9989, 271.2602, 270.2974, 269.2624, 268.4016, 267.2131}, 
                  {272.8893, 272.1634, 271.4237, 270.6559, 269.6612, 268.6197, 267.5608, 266.0682}, 
                  {272.2885, 271.5804, 270.8730, 270.0710, 269.0302, 267.9110, 266.7522, 265.2219}, 
                  {271.7005, 270.9252, 270.1328, 269.3186, 268.2512, 267.1068, 265.9259, 264.3659}, 
                  {270.9741, 270.1929, 269.3885, 268.5492, 267.4641, 266.2967, 265.0900, 263.5039}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {272.2359, 272.1037, 271.9303, 271.7172, 271.3291, 270.8811, 270.3738, 269.5632}, 
                  {272.3064, 272.1422, 271.9385, 271.6983, 271.2834, 270.8017, 270.2613, 269.4133}, 
                  {272.0295, 271.8151, 271.5656, 271.2819, 270.8208, 270.2900, 269.6949, 268.7887}, 
                  {271.4873, 271.2167, 270.9121, 270.5754, 270.0570, 269.4611, 268.8103, 267.8325}, 
                  {271.0623, 270.4214, 270.0631, 269.6726, 269.0908, 268.4333, 267.7106, 266.6610}, 
                  {270.7175, 270.0438, 269.3510, 268.6405, 267.9946, 267.2689, 266.4846, 265.3623}, 
                  {270.2534, 269.5516, 268.8356, 268.0934, 267.1485, 266.1038, 265.1882, 263.9930}, 
                  {269.6962, 268.9704, 268.2263, 267.4653, 266.5059, 265.4869, 264.3551, 262.8614}, 
                  {269.1055, 268.4128, 267.6360, 266.8438, 265.8058, 264.6952, 263.5273, 261.9895}, 
                  {268.4409, 267.6740, 266.8855, 266.0755, 265.0140, 263.8757, 262.6882, 261.1259}, 
                  {267.7011, 266.9200, 266.1227, 265.3018, 264.2226, 263.0522, 261.8385, 260.2496}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {268.9439, 268.8191, 268.6509, 268.4440, 268.0635, 267.6290, 267.1298, 266.3242}, 
                  {269.0452, 268.8942, 268.7040, 268.4671, 268.0620, 267.5960, 267.0639, 266.2259}, 
                  {268.7675, 268.5586, 268.3138, 268.0361, 267.5818, 267.0620, 266.4759, 265.5742}, 
                  {268.2088, 267.9394, 267.6364, 267.3017, 266.7896, 266.2025, 265.5502, 264.5756}, 
                  {267.7732, 267.1317, 266.7504, 266.3605, 265.7849, 265.1282, 264.4084, 263.3527}, 
                  {267.4051, 266.7313, 266.0390, 265.3297, 264.6499, 263.9256, 263.1383, 262.0068}, 
                  {266.9137, 266.2117, 265.4917, 264.7551, 263.8053, 262.7761, 261.8262, 260.6228}, 
                  {266.3286, 265.6026, 264.8923, 264.1273, 263.1953, 262.1112, 260.9840, 259.4780}, 
                  {265.7552, 264.9969, 264.2285, 263.4399, 262.4062, 261.2893, 260.1245, 258.5985}, 
                  {265.0140, 264.2443, 263.4593, 262.6498, 261.6050, 260.4637, 259.2653, 257.7105}, 
                  {264.2504, 263.4805, 262.6870, 261.8717, 260.8075, 259.6328, 258.4141, 256.8224}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {265.4667, 265.3457, 265.1870, 264.9869, 264.6151, 264.1944, 263.7052, 262.9134}, 
                  {265.6168, 265.4660, 265.2756, 265.0522, 264.6574, 264.2070, 263.6809, 262.8539}, 
                  {265.3246, 265.1211, 264.8807, 264.6072, 264.1599, 263.6532, 263.0854, 262.1927}, 
                  {264.7370, 264.4704, 264.1701, 263.8398, 263.3318, 262.7580, 262.1069, 261.1347}, 
                  {264.2994, 263.6585, 263.2439, 262.8542, 262.2820, 261.6322, 260.9113, 259.8539}, 
                  {263.9049, 263.2308, 262.5392, 261.8353, 261.0987, 260.3764, 259.5892, 258.4477}, 
                  {263.3826, 262.6804, 261.9609, 261.2258, 260.2847, 259.2901, 258.2192, 257.0687}, 
                  {262.7996, 262.0683, 261.3855, 260.6183, 259.6220, 258.5441, 257.4209, 255.9090}, 
                  {262.1431, 261.3790, 260.6081, 259.8232, 258.8118, 257.7008, 256.5351, 255.0074}, 
                  {261.3757, 260.6029, 259.8261, 259.0369, 258.0035, 256.8559, 255.6691, 254.0947}, 
                  {260.6096, 259.8344, 259.0443, 258.2399, 257.1853, 256.0156, 254.7825, 253.1961}
                  }
        }; // end of data.
        
        m_solar_extraction_t.assign( solar_extraction_t[0][0], 11, 8, 6 );

		const double solar_extraction_h[6][11][8] =   // Soar Extraction Steam Enthalpy (kJ/kg)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {1242.1965, 1241.4385, 1240.4487, 1239.2557, 1237.1068, 1234.6359, 1231.8942, 1227.5629}, 
                  {1241.9875, 1241.0504, 1239.8952, 1238.5575, 1236.1994, 1233.5881, 1230.6803, 1226.1490}, 
                  {1240.1595, 1238.9901, 1237.6275, 1236.0839, 1233.5572, 1230.6864, 1227.5489, 1222.7976}, 
                  {1237.3312, 1235.8749, 1234.2683, 1232.4661, 1229.6807, 1226.5331, 1223.1324, 1218.0859}, 
                  {1235.0957, 1231.7790, 1230.0384, 1228.0135, 1224.9307, 1221.5036, 1217.8225, 1212.4679}, 
                  {1233.3195, 1229.8556, 1226.2957, 1222.9376, 1219.6001, 1215.8852, 1211.9400, 1206.2781}, 
                  {1231.0287, 1227.4219, 1223.7252, 1219.8973, 1214.9438, 1209.9221, 1205.7118, 1199.7701}, 
                  {1228.3034, 1224.5833, 1220.7717, 1216.8199, 1211.6988, 1206.2953, 1200.7175, 1193.4786}, 
                  {1225.2324, 1221.4171, 1217.5140, 1213.4408, 1208.3467, 1203.0547, 1197.2703, 1189.6435}, 
                  {1222.0840, 1218.4681, 1214.4219, 1210.1776, 1204.7203, 1199.0223, 1193.1548, 1185.3825}, 
                  {1218.6897, 1214.6867, 1210.6094, 1206.3007, 1200.7436, 1194.8911, 1188.9188, 1181.0581}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {1227.4733, 1226.7468, 1225.7839, 1224.6259, 1222.5438, 1220.1251, 1217.4507, 1213.1807}, 
                  {1227.4274, 1226.5237, 1225.4139, 1224.0483, 1221.8166, 1219.2348, 1216.3924, 1211.9471}, 
                  {1225.6703, 1224.5288, 1223.1971, 1221.6836, 1219.2231, 1216.4001, 1213.3249, 1208.6204}, 
                  {1222.7879, 1221.3819, 1219.7976, 1218.0452, 1215.3107, 1212.2109, 1208.8505, 1203.8425}, 
                  {1220.5366, 1217.2362, 1215.5129, 1213.5060, 1210.4901, 1207.0931, 1203.4501, 1198.1118}, 
                  {1218.7495, 1215.2957, 1211.7499, 1208.3753, 1205.0756, 1201.3907, 1197.4593, 1191.8120}, 
                  {1216.4150, 1212.8278, 1209.1473, 1205.3787, 1200.4791, 1195.2452, 1191.1397, 1185.1931}, 
                  {1213.6242, 1209.9502, 1206.1515, 1202.2481, 1197.1867, 1191.7971, 1186.4357, 1179.2762}, 
                  {1210.4967, 1206.7087, 1203.0290, 1198.9872, 1194.0375, 1188.4523, 1182.6896, 1175.0613}, 
                  {1207.5541, 1203.6241, 1199.6428, 1195.4708, 1190.0824, 1184.3727, 1178.4967, 1170.7514}, 
                  {1203.7882, 1199.8203, 1195.7806, 1191.5258, 1186.0360, 1180.2504, 1174.2949, 1166.4492}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {1212.1506, 1211.4564, 1210.5272, 1209.4056, 1207.3793, 1205.0282, 1202.3947, 1198.2637}, 
                  {1212.2839, 1211.3475, 1210.2745, 1209.0148, 1206.8503, 1204.3348, 1201.5356, 1197.1732}, 
                  {1210.5827, 1209.4698, 1208.1658, 1206.6935, 1204.2959, 1201.5664, 1198.4930, 1193.8585}, 
                  {1207.6873, 1206.3000, 1204.7378, 1203.0111, 1200.3301, 1197.2814, 1193.9515, 1188.9961}, 
                  {1205.3986, 1202.1236, 1200.3747, 1198.3959, 1195.4223, 1192.0653, 1188.4329, 1183.1402}, 
                  {1203.5652, 1200.1404, 1196.6235, 1193.1670, 1189.9055, 1186.2478, 1182.3206, 1176.6973}, 
                  {1201.1601, 1197.6038, 1193.9586, 1190.2304, 1185.3865, 1180.1927, 1175.8869, 1169.9599}, 
                  {1198.3089, 1194.6412, 1190.9127, 1187.0507, 1182.0624, 1176.8540, 1171.5725, 1164.1536}, 
                  {1195.1275, 1191.5621, 1188.0083, 1183.9874, 1178.7848, 1173.2060, 1167.4460, 1159.8665}, 
                  {1192.0306, 1188.1402, 1184.1731, 1180.1061, 1174.7899, 1169.1055, 1163.2571, 1155.5577}, 
                  {1188.2593, 1184.3540, 1180.3416, 1176.1642, 1170.7788, 1165.0009, 1159.0453, 1151.2439}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {1196.2353, 1195.5652, 1194.6848, 1193.6022, 1191.6310, 1189.3564, 1186.7820, 1182.6761}, 
                  {1196.4236, 1195.5905, 1194.5564, 1193.3374, 1191.2324, 1188.7898, 1186.0526, 1181.7651}, 
                  {1194.8400, 1193.7524, 1192.4873, 1191.0497, 1188.7157, 1186.0312, 1183.0247, 1178.4567}, 
                  {1191.9160, 1190.5464, 1189.0058, 1187.3043, 1184.6883, 1181.6848, 1178.4091, 1173.4985}, 
                  {1189.6064, 1186.3640, 1184.5575, 1182.5911, 1179.6666, 1176.3656, 1172.7429, 1167.4950}, 
                  {1187.7176, 1184.3185, 1180.8306, 1177.2603, 1174.0269, 1170.3992, 1166.4856, 1160.8997}, 
                  {1185.2395, 1181.7091, 1178.1151, 1174.3976, 1169.6774, 1164.4719, 1159.9226, 1154.0021}, 
                  {1182.3079, 1178.6691, 1174.9463, 1171.1467, 1166.3697, 1161.3087, 1155.7014, 1148.3264}, 
                  {1179.2268, 1175.7647, 1171.8902, 1167.9477, 1162.7959, 1157.2981, 1151.5319, 1143.9654}, 
                  {1175.7947, 1171.9756, 1168.0569, 1164.0396, 1158.7895, 1153.1738, 1147.3312, 1139.6698}, 
                  {1172.0100, 1168.1336, 1164.1849, 1160.1280, 1154.8081, 1149.0532, 1143.1020, 1135.3357}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {1179.5483, 1178.9200, 1178.0725, 1177.0296, 1175.1113, 1172.9219, 1170.4079, 1166.3575}, 
                  {1179.9194, 1179.1590, 1178.2007, 1177.0074, 1174.9672, 1172.6218, 1169.9464, 1165.7398}, 
                  {1178.3726, 1177.3206, 1176.0889, 1174.6922, 1172.4095, 1169.8000, 1166.8605, 1162.3477}, 
                  {1175.4169, 1174.0638, 1172.5429, 1170.8641, 1168.2986, 1165.3613, 1162.1012, 1157.2419}, 
                  {1173.0995, 1169.8802, 1167.9721, 1166.0230, 1163.1509, 1159.8777, 1156.2958, 1151.0542}, 
                  {1171.1351, 1167.7623, 1164.3041, 1160.7675, 1157.3880, 1153.7933, 1149.8926, 1144.3000}, 
                  {1168.5653, 1165.0617, 1161.4758, 1157.8141, 1153.1045, 1148.0132, 1143.3261, 1137.4050}, 
                  {1165.5434, 1161.9314, 1158.4049, 1154.6136, 1150.0064, 1144.6593, 1139.1144, 1131.7291}, 
                  {1162.5962, 1158.8357, 1155.0323, 1151.1364, 1146.0427, 1140.5528, 1134.8415, 1127.3832}, 
                  {1158.8358, 1155.0317, 1151.1592, 1147.1736, 1142.0422, 1136.4504, 1130.5943, 1123.0194}, 
                  {1154.9863, 1151.1936, 1147.2922, 1143.2916, 1138.0820, 1132.3450, 1126.4089, 1118.6786}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {1162.0567, 1161.4520, 1160.6584, 1159.6575, 1157.7970, 1155.6935, 1153.2487, 1149.2979}, 
                  {1162.6970, 1161.9431, 1160.9912, 1159.8740, 1157.9009, 1155.6512, 1153.0256, 1148.9047}, 
                  {1161.1176, 1160.1009, 1158.9005, 1157.5354, 1155.3048, 1152.7799, 1149.9538, 1145.5183}, 
                  {1158.0696, 1156.7407, 1155.2451, 1153.6005, 1151.0751, 1148.2255, 1144.9960, 1140.1833}, 
                  {1155.7877, 1152.5973, 1150.5380, 1148.6050, 1145.7709, 1142.5561, 1138.9952, 1133.7829}, 
                  {1153.7332, 1150.3861, 1146.9584, 1143.4761, 1139.8412, 1136.2827, 1132.4109, 1126.8093}, 
                  {1151.0561, 1147.5799, 1144.0242, 1140.3981, 1135.7665, 1130.8823, 1125.6353, 1120.0143}, 
                  {1148.0937, 1144.4837, 1141.1193, 1137.3461, 1132.4568, 1127.1792, 1121.6930, 1114.3302}, 
                  {1144.7852, 1141.0248, 1137.2388, 1133.3904, 1128.4429, 1123.0213, 1117.3462, 1109.9297}, 
                  {1140.9498, 1137.1591, 1133.3560, 1129.4996, 1124.4602, 1118.8774, 1113.1178, 1105.4989}, 
                  {1137.1414, 1133.3518, 1129.4957, 1125.5771, 1120.4504, 1114.7774, 1108.8117, 1101.1580}
                  }
        }; // end of data.
        
        m_solar_extraction_h.assign( solar_extraction_h[0][0], 11, 8, 6 );

		const double solar_injection_h[6][11][8] =   // Soar Injection Steam Enthalpy (kJ/kg)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {2854.5459, 2854.7214, 2854.9165, 2855.1295, 2855.4880, 2855.8668, 2856.2640, 2856.8961}, 
                  {2850.9788, 2851.1656, 2851.3746, 2851.6035, 2851.9149, 2852.3671, 2852.8016, 2853.4566}, 
                  {2846.9450, 2847.1425, 2847.3642, 2847.6084, 2848.0264, 2848.4726, 2848.9428, 2849.6968}, 
                  {2842.7520, 2842.9293, 2843.1649, 2843.3918, 2843.8387, 2844.3175, 2844.8229, 2845.6349}, 
                  {2838.3044, 2838.4592, 2838.7130, 2838.9877, 2839.4341, 2839.9439, 2840.4829, 2841.3494}, 
                  {2833.5931, 2833.7775, 2833.9743, 2834.2132, 2834.7112, 2835.2419, 2835.8152, 2836.7367}, 
                  {2828.6687, 2828.8392, 2829.0527, 2829.2869, 2829.7673, 2830.2875, 2830.8832, 2831.8594}, 
                  {2823.5133, 2823.6910, 2823.9062, 2824.1620, 2824.6469, 2825.1925, 2825.7728, 2826.7221}, 
                  {2818.1262, 2818.3109, 2818.5350, 2818.8000, 2819.3041, 2819.8597, 2820.4699, 2821.4866}, 
                  {2812.5009, 2812.6768, 2812.9119, 2813.1914, 2813.7291, 2814.3202, 2814.9589, 2816.0202}, 
                  {2806.7087, 2806.9061, 2807.1456, 2807.3913, 2807.9497, 2808.5676, 2809.2312, 2810.3505}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {2857.0479, 2857.2054, 2857.3805, 2857.5709, 2857.8897, 2858.2265, 2858.5765, 2859.1368}, 
                  {2853.7325, 2853.9017, 2854.0902, 2854.2176, 2854.5670, 2854.9379, 2855.3248, 2855.9479}, 
                  {2849.9333, 2850.1136, 2850.3155, 2850.5374, 2850.9161, 2851.3199, 2851.7423, 2852.4251}, 
                  {2845.9029, 2846.0947, 2846.3100, 2846.5474, 2846.9550, 2847.3911, 2847.8484, 2848.5889}, 
                  {2841.6900, 2841.8379, 2842.0709, 2842.3234, 2842.6980, 2843.1663, 2843.6579, 2844.4549}, 
                  {2837.2098, 2837.3529, 2837.5398, 2837.7652, 2838.2287, 2838.7278, 2839.2525, 2840.1024}, 
                  {2832.4752, 2832.6295, 2832.8162, 2833.0434, 2833.4772, 2833.9549, 2834.5174, 2835.4212}, 
                  {2827.4835, 2827.6478, 2827.8666, 2828.0994, 2828.5494, 2829.0526, 2829.5826, 2830.4747}, 
                  {2822.2709, 2822.4488, 2822.6609, 2822.9129, 2823.3819, 2823.9029, 2824.4708, 2825.4197}, 
                  {2816.8073, 2816.9949, 2817.2243, 2817.4825, 2817.9873, 2818.5447, 2819.1470, 2820.1383}, 
                  {2811.1511, 2811.3428, 2811.5730, 2811.8470, 2812.3723, 2812.9776, 2813.5963, 2814.6288}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {2859.3773, 2859.5169, 2859.6715, 2859.8392, 2860.1189, 2860.4136, 2860.7206, 2861.2672}, 
                  {2856.3257, 2856.3973, 2856.5658, 2856.7498, 2857.0603, 2857.3894, 2857.7338, 2858.2826}, 
                  {2852.7741, 2852.9371, 2853.1193, 2853.3189, 2853.6588, 2854.0600, 2854.4005, 2855.0087}, 
                  {2848.9804, 2849.1551, 2849.3509, 2849.5662, 2849.9348, 2850.3287, 2850.7433, 2851.4086}, 
                  {2844.9232, 2845.0635, 2845.2758, 2845.5066, 2845.9036, 2846.3294, 2846.7785, 2847.4995}, 
                  {2840.6853, 2840.8340, 2841.0108, 2841.2170, 2841.6413, 2842.0980, 2842.5192, 2843.2947}, 
                  {2836.1347, 2836.2915, 2836.4775, 2836.6909, 2837.0936, 2837.5363, 2838.0485, 2838.8753}, 
                  {2831.3399, 2831.5041, 2831.6983, 2831.9234, 2832.3480, 2832.8106, 2833.3032, 2834.1365}, 
                  {2826.3201, 2826.4727, 2826.6642, 2826.9022, 2827.3517, 2827.8480, 2828.3802, 2829.2572}, 
                  {2821.0375, 2821.2171, 2821.4306, 2821.6806, 2822.1469, 2822.6667, 2823.2247, 2824.1434}, 
                  {2815.5654, 2815.7357, 2815.9680, 2816.2253, 2816.7006, 2817.2452, 2817.8298, 2818.7923}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {2861.5846, 2861.7081, 2861.8484, 2861.9943, 2862.2384, 2862.4907, 2862.7562, 2863.1743}, 
                  {2858.6663, 2858.8001, 2858.9486, 2859.1104, 2859.3824, 2859.6702, 2859.9707, 2860.4483}, 
                  {2855.4564, 2855.6022, 2855.7645, 2855.9422, 2856.2437, 2856.5638, 2856.9002, 2857.4371}, 
                  {2851.9109, 2852.0686, 2852.2449, 2852.4383, 2852.7683, 2853.1206, 2853.4906, 2854.0842}, 
                  {2848.0841, 2848.2158, 2848.4064, 2848.6155, 2848.9737, 2849.3570, 2849.7621, 2850.4103}, 
                  {2843.9935, 2844.1343, 2844.2997, 2844.4879, 2844.8736, 2845.2889, 2845.7273, 2846.4293}, 
                  {2839.6994, 2839.8483, 2840.0227, 2840.2233, 2840.6533, 2841.0022, 2841.4622, 2842.2160}, 
                  {2835.0948, 2835.2513, 2835.4356, 2835.6457, 2836.0336, 2836.4579, 2836.9248, 2837.6907}, 
                  {2830.2411, 2830.3942, 2830.5895, 2830.8118, 2831.2297, 2831.7259, 2832.1829, 2832.9976}, 
                  {2825.1580, 2825.3284, 2825.5304, 2825.7620, 2826.1998, 2826.7033, 2827.2244, 2828.0772}, 
                  {2819.8539, 2820.0303, 2820.2388, 2820.4788, 2820.9364, 2821.4452, 2821.9909, 2822.8837}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {2863.5421, 2863.6459, 2863.7598, 2863.8828, 2864.0861, 2864.2983, 2864.5175, 2864.8422}, 
                  {2860.9000, 2861.0556, 2861.2235, 2861.3461, 2861.5840, 2861.8342, 2862.0945, 2862.5073}, 
                  {2857.9677, 2858.0960, 2858.2388, 2858.3945, 2858.6584, 2858.9378, 2859.2303, 2859.6976}, 
                  {2854.6831, 2854.8238, 2854.9807, 2855.1526, 2855.4448, 2855.7560, 2856.0829, 2856.6066}, 
                  {2851.0993, 2851.2219, 2851.3909, 2851.5782, 2851.8982, 2852.2407, 2852.6011, 2853.1794}, 
                  {2847.2328, 2847.3647, 2847.5183, 2847.6916, 2848.0336, 2848.4071, 2848.8010, 2849.4324}, 
                  {2843.0829, 2843.2237, 2843.3875, 2843.5727, 2843.9134, 2844.2864, 2844.6918, 2845.3755}, 
                  {2838.7362, 2838.8845, 2839.0520, 2839.2486, 2839.6022, 2840.0026, 2840.4293, 2841.1312}, 
                  {2834.0651, 2834.2229, 2834.4507, 2834.6586, 2834.9989, 2835.4235, 2835.8774, 2836.6438}, 
                  {2829.2042, 2829.3678, 2829.5588, 2829.7458, 2830.1491, 2830.6310, 2831.0774, 2831.8957}, 
                  {2824.0506, 2824.2291, 2824.4259, 2824.6368, 2825.0738, 2825.5299, 2826.0530, 2826.8774}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {2865.2548, 2865.3183, 2865.4315, 2865.5307, 2865.6939, 2865.8632, 2866.0372, 2866.3085}, 
                  {2863.0056, 2863.1038, 2863.2121, 2863.3386, 2863.5365, 2863.7441, 2863.9452, 2864.3001}, 
                  {2860.2925, 2860.4035, 2860.5268, 2860.6611, 2860.8880, 2861.1273, 2861.4403, 2861.8450}, 
                  {2857.2850, 2857.4088, 2857.5465, 2857.6967, 2857.9519, 2858.2224, 2858.5068, 2858.9617}, 
                  {2853.9572, 2854.0698, 2854.2177, 2854.3836, 2854.6663, 2854.9681, 2855.2855, 2855.7946}, 
                  {2850.3273, 2850.4497, 2850.5908, 2850.7484, 2851.0497, 2851.3820, 2851.7318, 2852.2938}, 
                  {2846.4009, 2846.5323, 2846.6841, 2846.8542, 2847.1630, 2847.4967, 2847.8587, 2848.5383}, 
                  {2842.2518, 2842.3921, 2842.4834, 2842.6981, 2842.9998, 2843.3648, 2843.7864, 2844.3905}, 
                  {2837.8155, 2837.9383, 2838.1095, 2838.3017, 2838.6531, 2839.0413, 2839.4560, 2840.1607}, 
                  {2833.0877, 2833.2430, 2833.4627, 2833.6625, 2834.0337, 2834.4258, 2834.8879, 2835.6069}, 
                  {2828.1683, 2828.3277, 2828.5126, 2828.7211, 2829.1109, 2829.5467, 2829.9832, 2830.7358}
                  }
        }; // end of data.
        
        m_solar_injection_h.assign( solar_injection_h[0][0], 11, 8, 6 );

		const double plant_power_net[6][11][8] =   // Plant Power Net (MWe)
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {539.1571, 530.2940, 521.1846, 511.7106, 498.9952, 486.7965, 471.7899, 451.7190}, 
                  {548.2645, 539.3778, 530.2293, 520.7245, 508.0159, 495.8703, 480.9276, 460.8815}, 
                  {557.2507, 548.3603, 539.2259, 529.6968, 516.9987, 504.9285, 490.0439, 469.9578}, 
                  {566.2001, 557.3105, 548.1590, 538.6008, 525.9231, 513.9404, 499.1063, 478.9836}, 
                  {574.6858, 566.2450, 557.0308, 547.4459, 534.7890, 522.9004, 508.1174, 487.9578}, 
                  {582.7283, 574.2663, 565.5299, 556.2516, 543.6328, 531.8211, 517.0730, 496.8815}, 
                  {590.6422, 582.1586, 573.3841, 564.2368, 552.1401, 540.6886, 525.9793, 505.7344}, 
                  {598.4299, 589.9255, 581.1231, 572.0066, 560.0087, 548.6649, 534.3694, 514.5328}, 
                  {606.1063, 597.5743, 588.7369, 579.6558, 567.7658, 556.4603, 542.1713, 522.3070}, 
                  {613.6596, 605.1114, 596.2412, 587.1922, 575.3970, 564.1486, 549.8818, 529.9694}, 
                  {621.0986, 612.5113, 603.6003, 594.6326, 582.9459, 571.6403, 557.3788, 537.4571}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {512.8218, 504.3685, 495.6638, 486.6392, 474.5170, 462.7371, 448.3850, 428.9152}, 
                  {521.8950, 513.4159, 504.7174, 495.6637, 483.5138, 471.8113, 457.5355, 438.0817}, 
                  {530.9133, 522.4306, 513.7181, 504.6372, 492.4684, 480.8486, 466.6356, 447.2006}, 
                  {539.8564, 531.3702, 522.6465, 513.5382, 501.3696, 489.8275, 475.6822, 456.2128}, 
                  {548.3298, 540.2738, 531.5048, 522.3711, 510.2201, 498.7623, 484.6650, 465.1691}, 
                  {556.4046, 548.3241, 539.9800, 531.1362, 519.0117, 507.6442, 493.5998, 474.0655}, 
                  {564.3206, 556.2342, 547.8721, 539.0848, 527.3948, 516.5118, 502.4812, 482.9189}, 
                  {572.0988, 564.0242, 555.6010, 546.8346, 535.2356, 524.3889, 510.8288, 491.5886}, 
                  {579.7435, 571.6140, 563.2024, 554.4623, 542.9676, 532.1867, 518.6204, 499.3598}, 
                  {587.2793, 579.1193, 570.6894, 561.9964, 550.5955, 539.8137, 526.2363, 506.9561}, 
                  {594.6741, 586.4903, 578.0020, 569.3323, 558.0363, 547.2848, 533.7394, 514.4470}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {486.2845, 478.2090, 469.8896, 461.2518, 449.6239, 438.2188, 424.8151, 405.4634}, 
                  {495.3464, 487.2569, 478.9495, 470.2881, 458.6168, 447.2641, 433.9996, 414.6735}, 
                  {504.3413, 496.2456, 487.9266, 479.2326, 467.5364, 456.2727, 443.0996, 423.8019}, 
                  {513.2759, 505.1733, 496.8357, 488.1149, 476.4049, 465.2296, 452.1271, 432.8621}, 
                  {521.7437, 514.0598, 505.6906, 496.9357, 485.2157, 474.1314, 461.0928, 441.8240}, 
                  {529.7926, 522.0871, 514.1155, 505.6783, 493.9781, 482.9829, 469.9990, 450.7081}, 
                  {537.7200, 529.9931, 521.9924, 513.5545, 502.2777, 491.7568, 478.8542, 459.5372}, 
                  {545.5045, 537.7636, 529.7704, 521.2636, 510.0028, 499.6031, 487.0830, 468.1448}, 
                  {553.1288, 545.4047, 537.3581, 528.9038, 517.7234, 507.3617, 494.8691, 475.8703}, 
                  {560.6259, 552.8357, 544.7496, 536.3576, 525.2844, 514.9607, 502.5095, 483.4736}, 
                  {567.9823, 560.1898, 552.0407, 543.6565, 532.7285, 522.4402, 509.9931, 490.9363}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {459.8564, 452.1742, 444.3265, 436.1743, 425.2196, 414.2928, 401.2710, 382.8165}, 
                  {468.9294, 461.2607, 453.3964, 445.2115, 434.2074, 423.3658, 410.4293, 391.9955}, 
                  {477.9360, 470.2755, 462.4041, 454.1948, 443.1221, 432.3825, 419.5493, 401.1389}, 
                  {486.8499, 479.1818, 471.2997, 463.0692, 451.9764, 441.2900, 428.6095, 410.2267}, 
                  {495.3082, 488.0334, 480.1323, 471.8708, 460.7623, 450.1825, 437.5328, 419.2048}, 
                  {503.3589, 496.0721, 488.5367, 480.6135, 469.4961, 458.9782, 446.4154, 428.0997}, 
                  {511.2699, 503.9625, 496.4314, 488.4451, 477.7383, 467.6454, 455.2422, 436.8766}, 
                  {519.0522, 511.7225, 504.1346, 496.1333, 485.4290, 475.4597, 463.3493, 445.3448}, 
                  {526.7353, 519.3919, 511.7713, 503.7247, 492.9993, 483.1646, 471.1061, 453.0203}, 
                  {534.1760, 526.8391, 519.1966, 511.1637, 500.4940, 490.7245, 478.7165, 460.6291}, 
                  {541.5090, 534.1151, 526.4414, 518.4673, 507.9333, 498.1675, 486.1789, 468.0535}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {433.2472, 425.9992, 418.5806, 410.8700, 400.5004, 390.0183, 376.3185, 359.7410}, 
                  {442.3126, 435.0588, 427.6227, 419.8896, 409.4806, 399.0535, 385.4654, 368.8937}, 
                  {451.3173, 444.0593, 436.6089, 428.8534, 418.3907, 408.0701, 394.5873, 378.0329}, 
                  {460.2761, 453.0183, 445.5568, 437.7382, 427.2188, 416.9870, 403.6182, 387.0784}, 
                  {468.6696, 461.7986, 454.3546, 446.5414, 435.9937, 425.8181, 412.5990, 396.0807}, 
                  {476.7031, 469.8120, 462.6900, 455.2003, 444.7144, 434.6273, 421.5039, 404.9978}, 
                  {484.6125, 477.7000, 470.5493, 463.0184, 452.7966, 443.1484, 430.3053, 413.8363}, 
                  {492.3709, 485.4404, 478.2706, 470.7009, 460.4778, 450.9195, 438.3109, 422.0996}, 
                  {500.0324, 493.0764, 485.8682, 478.2544, 468.0170, 458.5523, 445.9875, 429.7970}, 
                  {507.5144, 500.5350, 493.2960, 485.6075, 475.4183, 466.0731, 453.5713, 437.3496}, 
                  {514.7999, 507.8374, 500.5747, 492.9159, 482.7669, 473.4925, 461.0424, 444.7540}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {406.5001, 399.6720, 392.6551, 385.3881, 375.6333, 365.6244, 352.3011, 336.5406}, 
                  {415.6397, 408.7901, 401.7721, 394.4691, 384.6660, 374.7052, 361.5342, 345.7289}, 
                  {424.6180, 417.7939, 410.7765, 403.4639, 393.5917, 383.6687, 370.6198, 354.8547}, 
                  {433.5249, 426.6833, 419.6486, 412.3062, 402.3992, 392.5944, 379.6234, 363.8973}, 
                  {441.9399, 435.4611, 428.4777, 421.1066, 411.1443, 401.4272, 388.5809, 372.8572}, 
                  {449.9617, 443.4729, 436.7660, 429.7334, 419.8317, 410.1767, 397.5018, 381.7828}, 
                  {457.8393, 451.3287, 444.5931, 437.4974, 427.8146, 418.5863, 406.2957, 390.6112}, 
                  {465.5921, 459.0575, 452.3225, 445.1820, 435.4472, 426.3063, 414.1562, 398.7898}, 
                  {473.2194, 466.6371, 459.8436, 452.6647, 442.9411, 433.8944, 421.8029, 406.4622}, 
                  {480.6697, 474.0616, 467.2370, 460.0435, 450.3393, 441.3682, 429.3775, 413.9471}, 
                  {487.9914, 481.3883, 474.5318, 467.2638, 457.5810, 448.7354, 436.7508, 421.3472}
                  }
        }; // end of data.
        
        m_plant_power_net.assign( plant_power_net[0][0], 11, 8, 6 );

		const double solar_heat_max[6][11][8] =   // solar injection heat max (kJ/kg) constrained by the maximum HP pressure: 103.5 bar
        {   // blocks for constant ambient pressure
            // rows for constant solar heat
            // columns for constant ambient temperature
            //    
            //Ambient P (bar)     Mininum     d_spacing       Max           n      
            //                 1.01325        -0.05      0.76325            6
            //    
            //Solar Heat (MWth)   Mininum     d_spacing       Max           n      
            //                    0.00        20.00       200.00           11
            //    
            //Ambient T (C)       Mininum     d_spacing       Max           n      
            //                    0.00         5.00        35.00            8
            //    
                {  // amibent pressure =  1.01325 bar
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}, 
                  {160.0827, 160.6410, 161.3485, 162.2116, 163.9646, 165.9226, 168.1039, 171.8230}
                  }, 
                {  // amibent pressure =  0.96325 bar
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}, 
                  {175.6005, 176.1637, 176.8584, 177.7091, 179.4405, 181.3864, 183.4939, 187.0956}
                  }, 
                {  // amibent pressure =  0.91325 bar
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}, 
                  {191.3691, 191.9232, 192.6151, 193.4419, 195.1146, 196.9957, 199.0368, 200.0000}
                  }, 
                {  // amibent pressure =  0.86325 bar
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}
                  }, 
                {  // amibent pressure =  0.81325 bar
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}
                  }, 
                {  // amibent pressure =  0.76325 bar
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}, 
                  {200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000, 200.0000}
                  }
        }; // end of data.
        
        m_solar_heat_max.assign( solar_heat_max[0][0], 11, 8, 6 );
	
	return;
}


double ngcc_power_cycle::get_performance_results( util::block_t<double> * p_current_table )
{
	int x_q_low = (int) ( (m_q_MW - m_q_sf_start)/m_delta_q );
	int x_q_high = x_q_low + 1;
	double f_x_high = (m_q_MW - m_q_sf_start)/m_delta_q - x_q_low;
	double f_x_low = 1.0 - f_x_high;
	int y_T_low = (int) ( (m_T_amb_C - m_T_amb_start)/m_delta_T );
	int y_T_high = y_T_low + 1;
	double f_y_high = (m_T_amb_C - m_T_amb_start)/m_delta_T - y_T_low;
	double f_y_low = 1.0 - f_y_high;
	int z_P_low = (int) ( (m_P_amb_bar -m_P_amb_start)/m_delta_P );
	int z_P_high = z_P_low + 1;
	double f_z_high = (m_P_amb_bar -m_P_amb_start)/m_delta_P - z_P_low;
	double f_z_low = 1.0 - f_z_high;

	/*
	double sum1 = 0.0;
	sum1+=f_x_low*f_y_low*f_z_low;
	sum1+=f_x_low*f_y_low*f_z_high;
	sum1+=f_x_low*f_y_high*f_z_low;
	sum1+=f_x_low*f_y_high*f_z_high;
	sum1+=f_x_high*f_y_low*f_z_low;
	sum1+=f_x_high*f_y_low*f_z_high;
	sum1+=f_x_high*f_y_high*f_z_low;
	sum1+=f_x_high*f_y_high*f_z_high;
	// Check that sum1 = 1*/

	double cube1 = p_current_table->at( x_q_low, y_T_low, z_P_low )  *f_x_low*f_y_low*f_z_low;
	double cube2 = p_current_table->at( x_q_low, y_T_low, z_P_high ) *f_x_low*f_y_low*f_z_high;
	double cube3 = p_current_table->at( x_q_low, y_T_high, z_P_low ) *f_x_low*f_y_high*f_z_low;
	double cube4 = p_current_table->at( x_q_low, y_T_high, z_P_high )*f_x_low*f_y_high*f_z_high;
	double cube5 = p_current_table->at( x_q_high, y_T_low, z_P_low )   *f_x_high*f_y_low*f_z_low;
	double cube6 = p_current_table->at( x_q_high, y_T_low, z_P_high )  *f_x_high*f_y_low*f_z_high;
	double cube7 = p_current_table->at( x_q_high, y_T_high, z_P_low )  *f_x_high*f_y_high*f_z_low;
	double cube8 = p_current_table->at( x_q_high, y_T_high, z_P_high ) *f_x_high*f_y_high*f_z_high;
	
	return (cube1 + cube2 + cube3 + cube4 + cube5 + cube6 + cube7 + cube8);
}
