# ARCH argument like arm64, armv7, armv7s, x86_64

VPATH = ../nlopt ../nlopt/direct ../nlopt/cdirect ../nlopt/praxis ../nlopt/luksan ../nlopt/crs

SIM=
ifeq (${ARCH}, i386)
	SIM=true
endif
ifeq (${ARCH}, x86_64)
	SIM=true
endif
ifeq (${SIM}, true)
	CC = /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc 
	CXX = /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++
	CFLAGS =  -I../  -I../nlopt/api -I../nlopt/util -I../nlopt  -DWX_PRECOMP -arch ${ARCH} -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk -miphoneos-version-min=8.0


else
	CC = /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc 
	CXX = /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++
	CFLAGS =  -I../  -I../nlopt/api -I../nlopt/util -I../nlopt  -DWX_PRECOMP -arch ${ARCH} -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk -D_IOS_VER
endif


CXXFLAGS = $(CFLAGS) -std=c++11 


OBJECTS = \
	auglag.o \
	bobyqa.o \
	ccsa_quadratic.o \
	cdirect.o \
	cobyla.o \
	crs.o \
	deprecated.o \
	DIRect.o \
	direct_wrap.o \
	DIRserial.o \
	DIRsubrout.o \
	esch.o \
	general.o \
	hybrid.o \
	isres.o \
	mlsl.o \
	mma.o \
	mssubs.o \
	mt19937ar.o \
	newuoa.o \
	nldrmd.o \
	optimize.o \
	options.o \
	plip.o \
	plis.o \
	pnet.o \
	praxis.o \
	pssubs.o \
	qsort_r.o \
	redblack.o \
	rescale.o \
	sbplx.o \
	slsqp.o \
	sobolseq.o \
	stop.o \
	timer.o


TARGET=nlopt_${ARCH}.a

$(TARGET):$(OBJECTS)
	ar rs $(TARGET) $(OBJECTS)

clean:
	rm -rf $(TARGET) $(OBJECTS)
