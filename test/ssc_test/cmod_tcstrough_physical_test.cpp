#include <gtest/gtest.h>
#include <memory>
#include <vector>
#include <unordered_map>
#include "simulation_test_info.h"
#include "computeModuleTest.h"

// first test must contain all possible inputs
std::vector<SimulationTestTable*> physTroughTests;
std::unordered_map<std::string, size_t> physTroughVarMap;
computeModuleTestData physTroughTesting(&physTroughTests, &physTroughVarMap, "tcstrough_physical");

// Set up data resource file paths
char weatherfile[150];
int d = sprintf(weatherfile, "%s/test/input_cases/pvsamv1_data/USA AZ Tucson (TMY2).csv", std::getenv("SSCDIR"));
//char dispatch_factors_ts[150];
//int e = sprintf(dispatch_factors_ts, "%s/../sdktool_debug/dispatch_factors_ts.csv", std::getenv("SAMNTDIR"));

// 0. Default Test Arrays and Matrices: using SAM GUI defaults
const char* W_aperture = "6, 6, 6, 6";
const char* A_aperture = "656, 656, 656, 656";
const char* TrackingError = "0.98799997568130493, 0.98799997568130493, 0.98799997568130493, 0.98799997568130493";
const char* GeomEffects = "0.95200002193450928, 0.95200002193450928, 0.95200002193450928, 0.95200002193450928";
const char* Rho_mirror_clean = "0.93000000715255737, 0.93000000715255737, 0.93000000715255737, 0.93000000715255737";
const char* Dirt_mirror = "0.97000002861022949, 0.97000002861022949, 0.97000002861022949, 0.97000002861022949";
const char* Error = "1, 1, 1, 1";
const char* Ave_Focal_Length = "2.1500000953674316, 2.1500000953674316, 2.1500000953674316, 2.1500000953674316";
const char* L_SCA = "115, 115, 115, 115";
const char* L_aperture = "14.375, 14.375, 14.375, 14.375";
const char* ColperSCA = "8, 8, 8, 8";
const char* Distance_SCA = "1, 1, 1, 1";
const char* IAM_matrix = "1, 0.032699998468160629, -0.13510000705718994,  "
                         "1, 0.032699998468160629, -0.13510000705718994,  "
                         "1, 0.032699998468160629, -0.13510000705718994,  "
                         "1, 0.032699998468160629, -0.13510000705718994";
const char* HCE_FieldFrac = "0.98500001430511475, 0.0099999997764825821, 0.004999999888241291, 0,  "
                            "1, 0, 0, 0,  "
                            "1, 0, 0, 0,  "
                            "1, 0, 0, 0";
const char* D_2 = "0.075999997556209564, 0.075999997556209564, 0.075999997556209564, 0.075999997556209564,  "
                  "0.075999997556209564, 0.075999997556209564, 0.075999997556209564, 0.075999997556209564,  "
                  "0.075999997556209564, 0.075999997556209564, 0.075999997556209564, 0.075999997556209564,  "
                  "0.075999997556209564, 0.075999997556209564, 0.075999997556209564, 0.075999997556209564";
const char* D_3 = "0.079999998211860657, 0.079999998211860657, 0.079999998211860657, 0.079999998211860657,  "
                  "0.079999998211860657, 0.079999998211860657, 0.079999998211860657, 0.079999998211860657,  "
                  "0.079999998211860657, 0.079999998211860657, 0.079999998211860657, 0.079999998211860657,  "
                  "0.079999998211860657, 0.079999998211860657, 0.079999998211860657, 0.079999998211860657";
const char* D_4 = "0.11500000208616257, 0.11500000208616257, 0.11500000208616257, 0.11500000208616257,  "
                  "0.11500000208616257, 0.11500000208616257, 0.11500000208616257, 0.11500000208616257,  "
                  "0.11500000208616257, 0.11500000208616257, 0.11500000208616257, 0.11500000208616257,  "
                  "0.11500000208616257, 0.11500000208616257, 0.11500000208616257, 0.11500000208616257";
const char* D_5 = "0.11999999731779099, 0.11999999731779099, 0.11999999731779099, 0.11999999731779099,  "
                  "0.11999999731779099, 0.11999999731779099, 0.11999999731779099, 0.11999999731779099,  "
                  "0.11999999731779099, 0.11999999731779099, 0.11999999731779099, 0.11999999731779099,  "
                  "0.11999999731779099, 0.11999999731779099, 0.11999999731779099, 0.11999999731779099";
const char* D_p = "0, 0, 0, 0,  "
                  "0, 0, 0, 0,  "
                  "0, 0, 0, 0,  "
                  "0, 0, 0, 0";
const char* Flow_type = "1, 1, 1, 1,  "
                        "1, 1, 1, 1,  "
                        "1, 1, 1, 1,  "
                        "1, 1, 1, 1";
const char* Rough = "4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05,  "
                    "4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05,  "
                    "4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05,  "
                    "4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05, 4.5000000682193786e-05";
const char* alpha_env = "0.019999999552965164, 0.019999999552965164, 0, 0,  "
                        "0.019999999552965164, 0.019999999552965164, 0, 0,  "
                        "0.019999999552965164, 0.019999999552965164, 0, 0,  "
                        "0.019999999552965164, 0.019999999552965164, 0, 0";
const char* epsilon_3_11 = "100, 0.064000003039836884,  "
                           "150, 0.066500000655651093,  "
                           "200, 0.070000000298023224,  "
                           "250, 0.074500001966953278,  "
                           "300, 0.079999998211860657,  "
                           "350, 0.086499996483325958,  "
                           "400, 0.093999996781349182,  "
                           "450, 0.10249999910593033,  "
                           "500, 0.1120000034570694";
const char* epsilon_3_21 = "100, 0.064000003039836884,  "
                           "150, 0.066500000655651093,  "
                           "200, 0.070000000298023224,  "
                           "250, 0.074500001966953278,  "
                           "300, 0.079999998211860657,  "
                           "350, 0.086499996483325958,  "
                           "400, 0.093999996781349182,  "
                           "450, 0.10249999910593033,  "
                           "500, 0.1120000034570694";
const char* epsilon_3_31 = "100, 0.064000003039836884,  "
                           "150, 0.066500000655651093,  "
                           "200, 0.070000000298023224,  "
                           "250, 0.074500001966953278,  "
                           "300, 0.079999998211860657,  "
                           "350, 0.086499996483325958,  "
                           "400, 0.093999996781349182,  "
                           "450, 0.10249999910593033,  "
                           "500, 0.1120000034570694";
const char* epsilon_3_41 = "100, 0.064000003039836884,  "
                           "150, 0.066500000655651093,  "
                           "200, 0.070000000298023224,  "
                           "250, 0.074500001966953278,  "
                           "300, 0.079999998211860657,  "
                           "350, 0.086499996483325958,  "
                           "400, 0.093999996781349182,  "
                           "450, 0.10249999910593033,  "
                           "500, 0.1120000034570694";
const char* alpha_abs = "0.96299999952316284, 0.96299999952316284, 0.80000001192092896, 0,  "
                        "0.96299999952316284, 0.96299999952316284, 0.80000001192092896, 0,  "
                        "0.96299999952316284, 0.96299999952316284, 0.80000001192092896, 0,  "
                        "0.96299999952316284, 0.96299999952316284, 0.80000001192092896, 0";
const char* Tau_envelope = "0.96399998664855957, 0.96399998664855957, 1, 0,  "
                           "0.96399998664855957, 0.96399998664855957, 1, 0,  "
                           "0.96399998664855957, 0.96399998664855957, 1, 0,  "
                           "0.96399998664855957, 0.96399998664855957, 1, 0";
const char* EPSILON_4 = "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0";
const char* EPSILON_5 = "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0,  "
                        "0.86000001430511475, 0.86000001430511475, 1, 0";
const char* GlazingIntactIn = "1, 1, 0, 1,  "
                              "1, 1, 0, 1,  "
                              "1, 1, 0, 1,  "
                              "1, 1, 0, 1";
const char* P_a = "9.9999997473787516e-05, 750, 750, 0,  "
                  "9.9999997473787516e-05, 750, 750, 0,  "
                  "9.9999997473787516e-05, 750, 750, 0,  "
                  "9.9999997473787516e-05, 750, 750, 0";
const char* AnnulusGas = "27, 1, 1, 27,  "
                         "27, 1, 1, 27,  "
                         "27, 1, 1, 27,  "
                         "27, 1, 1, 27";
const char* AbsorberMaterial = "1, 1, 1, 1,  "
                               "1, 1, 1, 1,  "
                               "1, 1, 1, 1,  "
                               "1, 1, 1, 1";
const char* Shadowing = "0.93500000238418579, 0.93500000238418579, 0.93500000238418579, 0.96299999952316284,  "
                        "0.93500000238418579, 0.93500000238418579, 0.93500000238418579, 0.96299999952316284,  "
                        "0.93500000238418579, 0.93500000238418579, 0.93500000238418579, 0.96299999952316284,  "
                        "0.93500000238418579, 0.93500000238418579, 0.93500000238418579, 0.96299999952316284";
const char* Dirt_HCE = "0.98000001907348633, 0.98000001907348633, 1, 0.98000001907348633,  "
                       "0.98000001907348633, 0.98000001907348633, 1, 0.98000001907348633,  "
                       "0.98000001907348633, 0.98000001907348633, 1, 0.98000001907348633,  "
                       "0.98000001907348633, 0.98000001907348633, 1, 0.98000001907348633";
const char* Design_loss = "190, 1270, 1500, 0,  "
                          "190, 1270, 1500, 0,  "
                          "190, 1270, 1500, 0,  "
                          "190, 1270, 1500, 0";
const char* SCAInfoArray = "1, 1,  "
                           "1, 1,  "
                           "1, 1,  "
                           "1, 1,  "
                           "1, 1,  "
                           "1, 1,  "
                           "1, 1,  "
                           "1, 1";
const char* SCADefocusArray = "8, 7, 6, 5, 4, 3, 2, 1";

const char* K_cpnt = "0.89999997615814209, 0, 0.18999999761581421, 0, 0.89999997615814209, -1, -1, -1, -1, -1, -1,  "
                     "0, 0.60000002384185791, 0.05000000074505806, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.41999998688697815, 0, 0.15000000596046448,  "
                     "0.05000000074505806, 0, 0.41999998688697815, 0, 0.60000002384185791, 0, 0.60000002384185791, 0, 0.15000000596046448, 0.60000002384185791, 0,  "
                     "0.89999997615814209, 0, 0.18999999761581421, 0, 0.89999997615814209, -1, -1, -1, -1, -1, -1";
const char* D_cpnt = "0.085000000894069672, 0.063500002026557922, 0.085000000894069672, 0.063500002026557922, 0.085000000894069672, -1, -1, -1, -1, -1, -1,  "
                     "0.085000000894069672, 0.085000000894069672, 0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.063500002026557922, 0.085000000894069672, 0.085000000894069672, 0.085000000894069672,  "
                     "0.085000000894069672, 0.063500002026557922, 0.085000000894069672, 0.063500002026557922, 0.085000000894069672, -1, -1, -1, -1, -1, -1";
const char* L_cpnt = "0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1,  "
                     "0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0,  "
                     "0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0,  "
                     "0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1";
const char* Type_cpnt = "0, 1, 0, 1, 0, -1, -1, -1, -1, -1, -1,  "
                        "1, 0, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0,  "
                        "0, 2, 0, 2, 0, 1, 0, 2, 0, 0, 1,  "
                        "0, 1, 0, 1, 0, -1, -1, -1, -1, -1, -1";
const char* sf_rnr_diams = "-1";
const char* sf_rnr_wallthicks = "-1";
const char* sf_rnr_lengths = "-1";
const char* sf_hdr_diams = "-1";
const char* sf_hdr_wallthicks = "-1";
const char* sf_hdr_lengths = "-1";
const char* bop_array = "0, 1, 0.4830000102519989, 0.51700001955032349, 0";
const char* k_tes_loss_coeffs = "0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0";
const char* sgs_diams = "-1";
const char* sgs_wallthicks = "-1";
const char* sgs_lengths = "0, 90, 100, 120, 0, 0, 0, 0, 80, 120, 80";
const char* aux_array = "0.02273000031709671, 1, 0.4830000102519989, 0.51700001955032349, 0";
const char* tslogic_a = "0, 0, 0, 0, 0, 0, 0, 0, 0";
const char* tslogic_b = "0, 0, 0, 0, 0, 0, 0, 0, 0";
const char* tslogic_c = "1.0499999523162842, 1, 1, 1, 1, 1, 1, 1, 1";
const char* ffrac = "0, 0, 0, 0, 0, 0, 0, 0, 0";
const char* weekday_schedule = "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5";
const char* weekend_schedule = "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,  "
                               "3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  "
                               "6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5";
const char* F_wc = "0, 0, 0, 0, 0, 0, 0, 0, 0";
const char* ud_T_htf_ind_od = "300, 0.012391712516546249, 0.059275288134813309, 0.066524550318717957, 0.02142857201397419, 0.071428574621677399, 0.085714288055896759, 1, 1, 1, 1, 1, 1,  "
                              "305.78945922851563, 0.022968079894781113, 0.10986694693565369, 0.12330347299575806, 0.039151448756456375, 0.13050483167171478, 0.1566057950258255, 1, 1, 1, 1, 1, 1,  "
                              "311.57894897460938, 0.033833939582109451, 0.16184337437152863, 0.18163652718067169, 0.05687432736158371, 0.18958109617233276, 0.22749730944633484, 1, 1, 1, 1, 1, 1,  "
                              "317.368408203125, 0.044982895255088806, 0.21517398953437805, 0.24148938059806824, 0.074597209692001343, 0.24865736067295074, 0.29838883876800537, 1, 1, 1, 1, 1, 1,  "
                              "323.15789794921875, 0.05640876293182373, 0.26982921361923218, 0.30282881855964661, 0.092320084571838379, 0.30773362517356873, 0.36928033828735352, 1, 1, 1, 1, 1, 1,  "
                              "328.94735717773438, 0.068105548620223999, 0.32578033208847046, 0.36562266945838928, 0.11004296690225601, 0.36680987477302551, 0.44017186760902405, 1, 1, 1, 1, 1, 1,  "
                              "334.73684692382813, 0.080067455768585205, 0.38299968838691711, 0.42983981966972351, 0.12776584923267365, 0.42588615417480469, 0.51106339693069458, 1, 1, 1, 1, 1, 1,  "
                              "340.52630615234375, 0.092288866639137268, 0.44146034121513367, 0.49545010924339294, 0.14548872411251068, 0.48496240377426147, 0.58195489645004272, 1, 1, 1, 1, 1, 1,  "
                              "346.3157958984375, 0.10476434975862503, 0.50113630294799805, 0.56242436170578003, 0.16321159899234772, 0.54403865337371826, 0.65284639596939087, 1, 1, 1, 1, 1, 1,  "
                              "352.10525512695313, 0.11748861521482468, 0.56200236082077026, 0.63073420524597168, 0.18093447387218475, 0.60311490297317505, 0.72373789548873901, 1, 1, 1, 1, 1, 1,  "
                              "357.89474487304688, 0.13045655190944672, 0.62403404712677002, 0.7003522515296936, 0.19865736365318298, 0.66219121217727661, 0.79462945461273193, 1, 1, 1, 1, 1, 1,  "
                              "363.6842041015625, 0.14366322755813599, 0.68720763921737671, 0.7712518572807312, 0.21638023853302002, 0.7212674617767334, 0.86552095413208008, 1, 1, 1, 1, 1, 1,  "
                              "369.47369384765625, 0.15710379183292389, 0.75150012969970703, 0.84340715408325195, 0.23410311341285706, 0.78034371137619019, 0.93641245365142822, 1, 1, 1, 1, 1, 1,  "
                              "375.26315307617188, 0.17077362537384033, 0.81688916683197021, 0.91679322719573975, 0.25182598829269409, 0.83941996097564697, 1.0073039531707764, 1, 1, 1, 1, 1, 1,  "
                              "381.05264282226563, 0.1846681535243988, 0.88335317373275757, 0.99138563871383667, 0.26954886317253113, 0.89849627017974854, 1.0781954526901245, 1, 1, 1, 1, 1, 1,  "
                              "386.84210205078125, 0.19878301024436951, 0.95087110996246338, 1.0671608448028564, 0.28727173805236816, 0.95757251977920532, 1.1490869522094727, 1, 1, 1, 1, 1, 1,  "
                              "392.631591796875, 0.21311391890048981, 1.0194224119186401, 1.1440958976745605, 0.30499464273452759, 1.0166487693786621, 1.2199785709381104, 1, 1, 1, 1, 1, 1,  "
                              "398.42105102539063, 0.22765673696994781, 1.0889874696731567, 1.2221685647964478, 0.32271751761436462, 1.0757250785827637, 1.2908700704574585, 1, 1, 1, 1, 1, 1,  "
                              "404.21054077148438, 0.2424074113368988, 1.1595467329025269, 1.3013571500778198, 0.34044039249420166, 1.1348012685775757, 1.3617615699768066, 1, 1, 1, 1, 1, 1,  "
                              "410, 0.25736206769943237, 1.2310817241668701, 1.3816406726837158, 0.3581632673740387, 1.1938775777816772, 1.4326530694961548, 1, 1, 1, 1, 1, 1";
const char* ud_T_amb_ind_od = "0, 0.071335971355438232, 1.1568559408187866, 1.4157259464263916, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "2.8947367668151855, 0.070495486259460449, 1.1459249258041382, 1.4028584957122803, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "5.7894735336303711, 0.069659397006034851, 1.1350511312484741, 1.3900582790374756, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "8.6842107772827148, 0.068827636539936066, 1.124233603477478, 1.3773243427276611, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "11.578947067260742, 0.068000137805938721, 1.113471508026123, 1.364655613899231, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "14.473684310913086, 0.067176833748817444, 1.1027640104293823, 1.3520511388778687, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "17.36842155456543, 0.066357657313346863, 1.0921101570129395, 1.3395099639892578, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "20.263158798217773, 0.065542556345462799, 1.0815093517303467, 1.327031135559082, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "23.157894134521484, 0.064731471240520477, 1.0709606409072876, 1.3146136999130249, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "26.052631378173828, 0.063924327492713928, 1.0604634284973145, 1.30225670337677, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "28.947368621826172, 0.063121087849140167, 1.0500167608261108, 1.2899593114852905, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "31.842105865478516, 0.062321685254573822, 1.039620041847229, 1.2777208089828491, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "34.736843109130859, 0.061526067554950714, 1.0292725563049316, 1.2655402421951294, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "37.631580352783203, 0.060734178870916367, 1.018973708152771, 1.2534167766571045, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "40.526317596435547, 0.059945970773696899, 1.0087225437164307, 1.2413495779037476, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "43.421051025390625, 0.059161391109228134, 0.99851870536804199, 1.2293380498886108, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "46.315788269042969, 0.058380391448736191, 0.98836135864257813, 1.2173812389373779, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "49.210525512695313, 0.057602923363447189, 0.97824990749359131, 1.2054784297943115, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "52.105262756347656, 0.05682893842458725, 0.96818381547927856, 1.1936290264129639, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1,  "
                              "55, 0.056058388203382492, 0.95816236734390259, 1.1818321943283081, 0.071428574621677399, 1, 1.1938775777816772, 1, 1, 1, 1, 1, 1";
const char* ud_m_dot_htf_ind_od = "0.30000001192092896, 0.24184487760066986, 0.20905359089374542, 0.20030727982521057, 0.30000001192092896, 0.30000001192092896, 0.30000001192092896, 1, 1, 1, 1, 1, 1,  "
                                  "0.34736841917037964, 0.29262182116508484, 0.25294578075408936, 0.24236312508583069, 0.34736841917037964, 0.34736841917037964, 0.34736841917037964, 1, 1, 1, 1, 1, 1,  "
                                  "0.39473685622215271, 0.34552481770515442, 0.29867574572563171, 0.28617987036705017, 0.39473685622215271, 0.39473685622215271, 0.39473685622215271, 1, 1, 1, 1, 1, 1,  "
                                  "0.44210526347160339, 0.40037104487419128, 0.34608548879623413, 0.33160609006881714, 0.44210526347160339, 0.44210526347160339, 0.44210526347160339, 1, 1, 1, 1, 1, 1,  "
                                  "0.48947367072105408, 0.45701181888580322, 0.39504644274711609, 0.37851864099502563, 0.48947367072105408, 0.48947367072105408, 0.48947367072105408, 1, 1, 1, 1, 1, 1,  "
                                  "0.53684210777282715, 0.51532334089279175, 0.44545161724090576, 0.4268149733543396, 0.53684210777282715, 0.53684210777282715, 0.53684210777282715, 1, 1, 1, 1, 1, 1,  "
                                  "0.58421051502227783, 0.57520079612731934, 0.49721038341522217, 0.47640827298164368, 0.58421051502227783, 0.58421051502227783, 0.58421051502227783, 1, 1, 1, 1, 1, 1,  "
                                  "0.63157892227172852, 0.63655394315719604, 0.55024480819702148, 0.52722382545471191, 0.63157892227172852, 0.63157892227172852, 0.63157892227172852, 1, 1, 1, 1, 1, 1,  "
                                  "0.67894738912582397, 0.69930434226989746, 0.60448694229125977, 0.57919669151306152, 0.67894738912582397, 0.67894738912582397, 0.67894738912582397, 1, 1, 1, 1, 1, 1,  "
                                  "0.72631579637527466, 0.76338285207748413, 0.6598772406578064, 0.63226950168609619, 0.72631579637527466, 0.72631579637527466, 0.72631579637527466, 1, 1, 1, 1, 1, 1,  "
                                  "0.77368420362472534, 0.82872819900512695, 0.71636253595352173, 0.68639159202575684, 0.77368420362472534, 0.77368420362472534, 0.77368420362472534, 1, 1, 1, 1, 1, 1,  "
                                  "0.82105261087417603, 0.89528554677963257, 0.77389544248580933, 0.74151748418807983, 0.82105261087417603, 0.82105261087417603, 0.82105261087417603, 1, 1, 1, 1, 1, 1,  "
                                  "0.86842107772827148, 0.96300536394119263, 0.83243328332901001, 0.79760628938674927, 0.86842107772827148, 0.86842107772827148, 0.86842107772827148, 1, 1, 1, 1, 1, 1,  "
                                  "0.91578948497772217, 1.0318429470062256, 0.89193731546401978, 0.85462081432342529, 0.91578948497772217, 0.91578948497772217, 0.91578948497772217, 1, 1, 1, 1, 1, 1,  "
                                  "0.96315789222717285, 1.1017575263977051, 0.95237225294113159, 0.91252726316452026, 0.96315789222717285, 0.96315789222717285, 0.96315789222717285, 1, 1, 1, 1, 1, 1,  "
                                  "1.0105262994766235, 1.1653280258178711, 1.0073233842849731, 0.96517932415008545, 1.0105262994766235, 1.0105262994766235, 1.0105262994766235, 1, 1, 1, 1, 1, 1,  "
                                  "1.0578947067260742, 1.2021303176879883, 1.0391356945037842, 0.99566078186035156, 1.0578947067260742, 1.0578947067260742, 1.0578947067260742, 1, 1, 1, 1, 1, 1,  "
                                  "1.1052631139755249, 1.2366691827774048, 1.0689915418624878, 1.0242675542831421, 1.1052631139755249, 1.1052631139755249, 1.1052631139755249, 1, 1, 1, 1, 1, 1,  "
                                  "1.1526315212249756, 1.2687950134277344, 1.0967614650726318, 1.0508755445480347, 1.1526315212249756, 1.1526315212249756, 1.1526315212249756, 1, 1, 1, 1, 1, 1,  "
                                  "1.2000000476837158, 1.2983372211456299, 1.1222981214523315, 1.0753438472747803, 1.2000000476837158, 1.2000000476837158, 1.2000000476837158, 1, 1, 1, 1, 1, 1";
const char* dispatch_sched_weekday = "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5";
const char* dispatch_sched_weekend = "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5,  "
                                     "6, 6, 6, 6, 6, 6, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5";

// 1. Default Test Info: using SAM GUI defaults
// data_type = [STR | NUM | ARR | MAT]
// length = nrows, width = ncols
TestInfo physTroughPPASingleDefaultInfo[] = {
/*  SSC Var Name                            Data Type           Test Values             Length,Width */
    {"file_name",                           STR,                weatherfile             },
    {"track_mode",                          NUM,                "1"                     },
	{"tilt",                                NUM,                "0"                     },
	{"azimuth",                             NUM,                "0"                     },
	{"system_capacity",                     NUM,                "99899.9921875"         },
	{"nSCA",                                NUM,                "8"                     },
	{"nHCEt",                               NUM,                "4"                     },
	{"nColt",                               NUM,                "4"                     },
	{"nHCEVar",                             NUM,                "4"                     },
	{"nLoops",                              NUM,                "181"                   },
	{"eta_pump",                            NUM,                "0.85000002384185791"   },
	{"HDR_rough",                           NUM,                "4.5699998736381531e-05"},
	{"theta_stow",                          NUM,                "170"                   },
	{"theta_dep",                           NUM,                "10"                    },
	{"Row_Distance",                        NUM,                "15"                    },
	{"FieldConfig",                         NUM,                "2"                     },
	{"T_startup",                           NUM,                "300"                   },
	{"P_ref",                               NUM,                "111"                   },
	{"m_dot_htfmin",                        NUM,                "1"                     },
	{"m_dot_htfmax",                        NUM,                "12"                    },
	{"T_loop_in_des",                       NUM,                "293"                   },
	{"T_loop_out",                          NUM,                "391"                   },
	{"Fluid",                               NUM,                "21"                    },
	{"T_fp",                                NUM,                "150"                   },
	{"I_bn_des",                            NUM,                "950"                   },
    {"calc_design_pipe_vals",               NUM,                "1"                     },
	{"V_hdr_cold_max",                      NUM,                "3"                     },
	{"V_hdr_cold_min",                      NUM,                "2"                     },
    {"V_hdr_hot_max",                       NUM,                "3"                     },
    {"V_hdr_hot_min",                       NUM,                "2"                     },
    {"N_max_hdr_diams",                     NUM,                "10"                    },
    {"L_rnr_pb",                            NUM,                "25"                    },
    {"L_rnr_per_xpan",                      NUM,                "70"                    },
    {"L_xpan_hdr",                          NUM,                "20"                    },
    {"L_xpan_rnr",                          NUM,                "20"                    },
    {"Min_rnr_xpans",                       NUM,                "1"                     },
    {"northsouth_field_sep",                NUM,                "20"                    },
    {"N_hdr_per_xpan",                      NUM,                "2"                     },
    {"offset_xpan_hdr",                     NUM,                "1"                     },
	{"Pipe_hl_coef",                        NUM,                "0.44999998807907104"   },
	{"SCA_drives_elec",                     NUM,                "125"                   },
	{"fthrok",                              NUM,                "1"                     },
	{"fthrctrl",                            NUM,                "2"                     },
	{"water_usage_per_wash",                NUM,                "0.69999998807907104"   },
	{"washing_frequency",                   NUM,                "63"                    },
	{"accept_mode",                         NUM,                "0"                     },
	{"accept_init",                         NUM,                "0"                     },
	{"accept_loc",                          NUM,                "1"                     },
	{"solar_mult",                          NUM,                "2"                     },
	{"mc_bal_hot",                          NUM,                "0.20000000298023224"   },
	{"mc_bal_cold",                         NUM,                "0.20000000298023224"   },
	{"mc_bal_sca",                          NUM,                "4.5"                   },
	{"W_aperture",                          ARR,                W_aperture,             4},
	{"A_aperture",                          ARR,                A_aperture,             4},
	{"TrackingError",                       ARR,                TrackingError,          4},
	{"GeomEffects",                         ARR,                GeomEffects,            4},
	{"Rho_mirror_clean",                    ARR,                Rho_mirror_clean,       4},
	{"Dirt_mirror",                         ARR,                Dirt_mirror,            4},
	{"Error",                               ARR,                Error,                  4},
	{"Ave_Focal_Length",                    ARR,                Ave_Focal_Length,       4},
	{"L_SCA",                               ARR,                L_SCA,                  4},
	{"L_aperture",                          ARR,                L_aperture,             4},
	{"ColperSCA",                           ARR,                ColperSCA,              4},
	{"Distance_SCA",                        ARR,                Distance_SCA,           4},
	{"IAM_matrix",                          MAT,                IAM_matrix,             4,3},
	{"HCE_FieldFrac",                       MAT,                HCE_FieldFrac,          4,4},
	{"D_2",                                 MAT,                D_2,                    4,4},
	{"D_3",                                 MAT,                D_3,                    4,4},
	{"D_4",                                 MAT,                D_4,                    4,4},
	{"D_5",                                 MAT,                D_5,                    4,4},
	{"D_p",                                 MAT,                D_p,                    4,4},
	{"Flow_type",                           MAT,                Flow_type,              4,4},
	{"Rough",                               MAT,                Rough,                  4,4},
	{"alpha_env",                           MAT,                alpha_env,              4,4},
	{"epsilon_3_11",                        MAT,                epsilon_3_11,           9,2},
	{"epsilon_3_12",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_13",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_14",                        MAT,                "0",                    1,1},
	{"epsilon_3_21",                        MAT,                epsilon_3_21,           9,2},
	{"epsilon_3_22",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_23",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_24",                        MAT,                "0",                    1,1},
	{"epsilon_3_31",                        MAT,                epsilon_3_31,           9,2},
	{"epsilon_3_32",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_33",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_34",                        MAT,                "0",                    1,1},
	{"epsilon_3_41",                        MAT,                epsilon_3_41,           9,2},
	{"epsilon_3_42",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_43",                        MAT,                "0.64999997615814209",  1,1},
	{"epsilon_3_44",                        MAT,                "0",                    1,1},
	{"alpha_abs",                           MAT,                alpha_abs,              4,4},
	{"Tau_envelope",                        MAT,                Tau_envelope,           4,4},
	{"EPSILON_4",                           MAT,                EPSILON_4,              4,4},
	{"EPSILON_5",                           MAT,                EPSILON_5,              4,4},
	{"GlazingIntactIn",                     MAT,                GlazingIntactIn,        4,4},
	{"P_a",                                 MAT,                P_a,                    4,4},
	{"AnnulusGas",                          MAT,                AnnulusGas,             4,4},
	{"AbsorberMaterial",                    MAT,                AbsorberMaterial,       4,4},
	{"Shadowing",                           MAT,                Shadowing,              4,4},
	{"Dirt_HCE",                            MAT,                Dirt_HCE,               4,4},
	{"Design_loss",                         MAT,                Design_loss,            4,4},
	{"SCAInfoArray",                        MAT,                SCAInfoArray,           8,2},
	{"SCADefocusArray",                     ARR,                SCADefocusArray,        8},
    {"K_cpnt",                              MAT,                K_cpnt,                 11,11},
    {"D_cpnt",                              MAT,                D_cpnt,                 11,11},
    {"L_cpnt",                              MAT,                L_cpnt,                 11,11},
    {"Type_cpnt",                           MAT,                Type_cpnt,              11,11},
    {"custom_sf_pipe_sizes",                NUM,                "0"                     },
    {"sf_rnr_diams",                        ARR,                sf_rnr_diams,           1},
    {"sf_rnr_wallthicks",                   ARR,                sf_rnr_wallthicks,      1},
    {"sf_rnr_lengths",                      ARR,                sf_rnr_lengths,         1},
    {"sf_hdr_diams",                        ARR,                sf_hdr_diams,           1},
    {"sf_hdr_wallthicks",                   ARR,                sf_hdr_wallthicks,      1},
    {"sf_hdr_lengths",                      ARR,                sf_hdr_lengths,         1},
	{"field_fl_props",                      MAT,                "0",                    1,1},
	{"store_fl_props",                      MAT,                "1",                    1,1},
	{"store_fluid",                         NUM,                "18"                    },
	{"tshours",                             NUM,                "6"                     },
	{"is_hx",                               NUM,                "1"                     },
	{"dt_hot",                              NUM,                "5"                     },
	{"dt_cold",                             NUM,                "5"                     },
	{"hx_config",                           NUM,                "2"                     },
	{"q_max_aux",                           NUM,                "311.79776000976563"    },
	{"T_set_aux",                           NUM,                "391"                   },
	{"V_tank_hot_ini",                      NUM,                "1265.220703125"        },
	{"T_tank_cold_ini",                     NUM,                "300"                   },
	{"vol_tank",                            NUM,                "25304.4140625"         },
	{"h_tank",                              NUM,                "20"                    },
	{"h_tank_min",                          NUM,                "1"                     },
	{"u_tank",                              NUM,                "0.40000000596046448"   },
	{"tank_pairs",                          NUM,                "1"                     },
	{"cold_tank_Thtr",                      NUM,                "250"                   },
	{"hot_tank_Thtr",                       NUM,                "365"                   },
	{"tank_max_heat",                       NUM,                "25"                    },
    {"tanks_in_parallel",                   NUM,                "1"                     },
    {"has_hot_tank_bypass",                 NUM,                "0"                     },
    {"T_tank_hot_inlet_min",                NUM,                "400"                   },
	{"q_pb_design",                         NUM,                "311.79776000976563"    },
	{"W_pb_design",                         NUM,                "111"                   },
	{"cycle_max_frac",                      NUM,                "1.0499999523162842"    },
	{"cycle_cutoff_frac",                   NUM,                "0.20000000298023224"   },
	{"pb_pump_coef",                        NUM,                "0.55000001192092896"   },
	{"tes_pump_coef",                       NUM,                "0.15000000596046448"   },
    {"V_tes_des",                           NUM,                "1.85"                  },
    {"custom_tes_p_loss",                   NUM,                "0"                     },
    {"k_tes_loss_coeffs",                   ARR,                k_tes_loss_coeffs,      11},
    {"custom_sgs_pipe_sizes",               NUM,                "0"                     },
    {"sgs_diams",                           ARR,                sgs_diams,              1},
    {"sgs_wallthicks",                      ARR,                sgs_wallthicks,         1},
    {"sgs_lengths",                         ARR,                sgs_lengths,            11},
    {"DP_SGS",                              NUM,                "0",                    },
	{"pb_fixed_par",                        NUM,                "0.0054999999701976776" },
	{"bop_array",                           ARR,                bop_array,              5},
	{"aux_array",                           ARR,                aux_array,              5},
	{"fossil_mode",                         NUM,                "1"                     },
	{"t_standby_reset",                     NUM,                "2"                     },
	{"sf_type",                             NUM,                "1"                     },
	{"tes_type",                            NUM,                "1"                     },
	{"tslogic_a",                           ARR,                tslogic_a,              9},
	{"tslogic_b",                           ARR,                tslogic_b,              9},
	{"tslogic_c",                           ARR,                tslogic_c,              9},
	{"ffrac",                               ARR,                ffrac,                  9},
	{"tc_fill",                             NUM,                "7"                     },
	{"tc_void",                             NUM,                "0.25"                  },
	{"t_dis_out_min",                       NUM,                "500"                   },
	{"t_ch_out_max",                        NUM,                "500"                   },
	{"nodes",                               NUM,                "2000"                  },
	{"f_tc_cold",                           NUM,                "2"                     },
	{"weekday_schedule",                    MAT,                weekday_schedule,       12,24},
	{"weekend_schedule",                    MAT,                weekend_schedule,       12,24},
	{"pc_config",                           NUM,                "0"                     },
	{"eta_ref",                             NUM,                "0.35600000619888306"   },
	{"startup_time",                        NUM,                "0.5"                   },
	{"startup_frac",                        NUM,                "0.20000000298023224"   },
	{"q_sby_frac",                          NUM,                "0.20000000298023224"   },
	{"dT_cw_ref",                           NUM,                "10"                    },
	{"T_amb_des",                           NUM,                "42"                    },
	{"P_boil",                              NUM,                "100"                   },
	{"CT",                                  NUM,                "2"                     },
	{"T_approach",                          NUM,                "5"                     },
	{"T_ITD_des",                           NUM,                "16"                    },
	{"P_cond_ratio",                        NUM,                "1.0027999877929688"    },
	{"pb_bd_frac",                          NUM,                "0.019999999552965164"  },
	{"P_cond_min",                          NUM,                "1.25"                  },
	{"n_pl_inc",                            NUM,                "8"                     },
	{"F_wc",                                ARR,                F_wc,                   9},
	{"tech_type",                           NUM,                "2"                     },
	{"ud_T_amb_des",                        NUM,                "43"                    },
	{"ud_f_W_dot_cool_des",                 NUM,                "0"                     },
	{"ud_m_dot_water_cool_des",             NUM,                "0"                     },
	{"ud_T_htf_low",                        NUM,                "300"                   },
	{"ud_T_htf_high",                       NUM,                "410"                   },
	{"ud_T_amb_low",                        NUM,                "0"                     },
	{"ud_T_amb_high",                       NUM,                "55"                    },
	{"ud_m_dot_htf_low",                    NUM,                "0.30000001192092896"   },
	{"ud_m_dot_htf_high",                   NUM,                "1.2000000476837158"    },
	{"ud_T_htf_ind_od",                     MAT,                ud_T_htf_ind_od,        20,13},
	{"ud_T_amb_ind_od",                     MAT,                ud_T_amb_ind_od,        20,13},
	{"ud_m_dot_htf_ind_od",                 MAT,                ud_m_dot_htf_ind_od,    20,13},
	{"eta_lhv",                             NUM,                "0.89999997615814209"   },
	{"eta_tes_htr",                         NUM,                "0.98000001907348633"   },
	{"adjust:constant",                     NUM,                "4"                     },
	{"analysis_period",                     NUM,                "25"                    },
	{"federal_tax_rate",                    NUM,                "28"                    },
	{"state_tax_rate",                      NUM,                "7"                     },
	{"property_tax_rate",                   NUM,                "0"                     },
	{"prop_tax_cost_assessed_percent",      NUM,                "100"                   },
	{"prop_tax_assessed_decline",           NUM,                "0"                     },
	{"real_discount_rate",                  NUM,                "5.5"                   },
	{"inflation_rate",                      NUM,                "2.5"                   },
	{"insurance_rate",                      NUM,                "0.5"                   },
	{"om_fixed",                            NUM,                "0"                     },
	{"om_fixed_escal",                      NUM,                "0"                     },
	{"om_production",                       NUM,                "4"                     },
	{"om_production_escal",                 NUM,                "0"                     },
	{"om_capacity",                         NUM,                "66"                    },
	{"om_capacity_escal",                   NUM,                "0"                     },
	{"om_fuel_cost",                        NUM,                "0"                     },
	{"om_fuel_cost_escal",                  NUM,                "0"                     },
	{"itc_fed_amount",                      NUM,                "0"                     },
	{"itc_fed_amount_deprbas_fed",          NUM,                "1"                     },
	{"itc_fed_amount_deprbas_sta",          NUM,                "1"                     },
	{"itc_sta_amount",                      NUM,                "0"                     },
	{"itc_sta_amount_deprbas_fed",          NUM,                "0"                     },
	{"itc_sta_amount_deprbas_sta",          NUM,                "0"                     },
	{"itc_fed_percent",                     NUM,                "30"                    },
	{"itc_fed_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"itc_fed_percent_deprbas_fed",         NUM,                "1"                     },
	{"itc_fed_percent_deprbas_sta",         NUM,                "1"                     },
	{"itc_sta_percent",                     NUM,                "0"                     },
	{"itc_sta_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"itc_sta_percent_deprbas_fed",         NUM,                "0"                     },
	{"itc_sta_percent_deprbas_sta",         NUM,                "0"                     },
	{"ptc_fed_amount",                      NUM,                "0"                     },
	{"ptc_fed_term",                        NUM,                "10"                    },
	{"ptc_fed_escal",                       NUM,                "0"                     },
	{"ptc_sta_amount",                      NUM,                "0"                     },
	{"ptc_sta_term",                        NUM,                "10"                    },
	{"ptc_sta_escal",                       NUM,                "0"                     },
	{"ibi_fed_amount",                      NUM,                "0"                     },
	{"ibi_fed_amount_tax_fed",              NUM,                "1"                     },
	{"ibi_fed_amount_tax_sta",              NUM,                "1"                     },
	{"ibi_fed_amount_deprbas_fed",          NUM,                "0"                     },
	{"ibi_fed_amount_deprbas_sta",          NUM,                "0"                     },
	{"ibi_sta_amount",                      NUM,                "0"                     },
	{"ibi_sta_amount_tax_fed",              NUM,                "1"                     },
	{"ibi_sta_amount_tax_sta",              NUM,                "1"                     },
	{"ibi_sta_amount_deprbas_fed",          NUM,                "0"                     },
	{"ibi_sta_amount_deprbas_sta",          NUM,                "0"                     },
	{"ibi_uti_amount",                      NUM,                "0"                     },
	{"ibi_uti_amount_tax_fed",              NUM,                "1"                     },
	{"ibi_uti_amount_tax_sta",              NUM,                "1"                     },
	{"ibi_uti_amount_deprbas_fed",          NUM,                "0"                     },
	{"ibi_uti_amount_deprbas_sta",          NUM,                "0"                     },
	{"ibi_oth_amount",                      NUM,                "0"                     },
	{"ibi_oth_amount_tax_fed",              NUM,                "1"                     },
	{"ibi_oth_amount_tax_sta",              NUM,                "1"                     },
	{"ibi_oth_amount_deprbas_fed",          NUM,                "0"                     },
	{"ibi_oth_amount_deprbas_sta",          NUM,                "0"                     },
	{"ibi_fed_percent",                     NUM,                "0"                     },
	{"ibi_fed_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"ibi_fed_percent_tax_fed",             NUM,                "1"                     },
	{"ibi_fed_percent_tax_sta",             NUM,                "1"                     },
	{"ibi_fed_percent_deprbas_fed",         NUM,                "0"                     },
	{"ibi_fed_percent_deprbas_sta",         NUM,                "0"                     },
	{"ibi_sta_percent",                     NUM,                "0"                     },
	{"ibi_sta_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"ibi_sta_percent_tax_fed",             NUM,                "1"                     },
	{"ibi_sta_percent_tax_sta",             NUM,                "1"                     },
	{"ibi_sta_percent_deprbas_fed",         NUM,                "0"                     },
	{"ibi_sta_percent_deprbas_sta",         NUM,                "0"                     },
	{"ibi_uti_percent",                     NUM,                "0"                     },
	{"ibi_uti_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"ibi_uti_percent_tax_fed",             NUM,                "1"                     },
	{"ibi_uti_percent_tax_sta",             NUM,                "1"                     },
	{"ibi_uti_percent_deprbas_fed",         NUM,                "0"                     },
	{"ibi_uti_percent_deprbas_sta",         NUM,                "0"                     },
	{"ibi_oth_percent",                     NUM,                "0"                     },
	{"ibi_oth_percent_maxvalue",            NUM,                "9.9999996802856925e+37"},
	{"ibi_oth_percent_tax_fed",             NUM,                "1"                     },
	{"ibi_oth_percent_tax_sta",             NUM,                "1"                     },
	{"ibi_oth_percent_deprbas_fed",         NUM,                "0"                     },
	{"ibi_oth_percent_deprbas_sta",         NUM,                "0"                     },
	{"cbi_fed_amount",                      NUM,                "0"                     },
	{"cbi_fed_maxvalue",                    NUM,                "9.9999996802856925e+37"},
	{"cbi_fed_tax_fed",                     NUM,                "1"                     },
	{"cbi_fed_tax_sta",                     NUM,                "1"                     },
	{"cbi_fed_deprbas_fed",                 NUM,                "0"                     },
	{"cbi_fed_deprbas_sta",                 NUM,                "0"                     },
	{"cbi_sta_amount",                      NUM,                "0"                     },
	{"cbi_sta_maxvalue",                    NUM,                "9.9999996802856925e+37"},
	{"cbi_sta_tax_fed",                     NUM,                "1"                     },
	{"cbi_sta_tax_sta",                     NUM,                "1"                     },
	{"cbi_sta_deprbas_fed",                 NUM,                "0"                     },
	{"cbi_sta_deprbas_sta",                 NUM,                "0"                     },
	{"cbi_uti_amount",                      NUM,                "0"                     },
	{"cbi_uti_maxvalue",                    NUM,                "9.9999996802856925e+37"},
	{"cbi_uti_tax_fed",                     NUM,                "1"                     },
	{"cbi_uti_tax_sta",                     NUM,                "1"                     },
	{"cbi_uti_deprbas_fed",                 NUM,                "0"                     },
	{"cbi_uti_deprbas_sta",                 NUM,                "0"                     },
	{"cbi_oth_amount",                      NUM,                "0"                     },
	{"cbi_oth_maxvalue",                    NUM,                "9.9999996802856925e+37"},
	{"cbi_oth_tax_fed",                     NUM,                "1"                     },
	{"cbi_oth_tax_sta",                     NUM,                "1"                     },
	{"cbi_oth_deprbas_fed",                 NUM,                "0"                     },
	{"cbi_oth_deprbas_sta",                 NUM,                "0"                     },
	{"pbi_fed_amount",                      NUM,                "0"                     },
	{"pbi_fed_term",                        NUM,                "0"                     },
	{"pbi_fed_escal",                       NUM,                "0"                     },
	{"pbi_fed_tax_fed",                     NUM,                "1"                     },
	{"pbi_fed_tax_sta",                     NUM,                "1"                     },
	{"pbi_sta_amount",                      NUM,                "0"                     },
	{"pbi_sta_term",                        NUM,                "0"                     },
	{"pbi_sta_escal",                       NUM,                "0"                     },
	{"pbi_sta_tax_fed",                     NUM,                "1"                     },
	{"pbi_sta_tax_sta",                     NUM,                "1"                     },
	{"pbi_uti_amount",                      NUM,                "0"                     },
	{"pbi_uti_term",                        NUM,                "0"                     },
	{"pbi_uti_escal",                       NUM,                "0"                     },
	{"pbi_uti_tax_fed",                     NUM,                "1"                     },
	{"pbi_uti_tax_sta",                     NUM,                "1"                     },
	{"pbi_oth_amount",                      NUM,                "0"                     },
	{"pbi_oth_term",                        NUM,                "0"                     },
	{"pbi_oth_escal",                       NUM,                "0"                     },
	{"pbi_oth_tax_fed",                     NUM,                "1"                     },
	{"pbi_oth_tax_sta",                     NUM,                "1"                     },
	{"degradation",                         NUM,                "0"                     },
	{"roe_input",                           NUM,                "0"                     },
	{"loan_moratorium",                     NUM,                "0"                     },
	{"system_use_recapitalization",         NUM,                "0"                     },
	{"system_use_lifetime_output",          NUM,                "0"                     },
	{"ppa_multiplier_model",                NUM,                "0"                     },
    //{"dispatch_factors_ts",                 STR,                dispatch_factors_ts     },
	{"dispatch_factor1",                    NUM,                "2.0639998912811279"    },
	{"dispatch_factor2",                    NUM,                "1.2000000476837158"    },
	{"dispatch_factor3",                    NUM,                "1"                     },
	{"dispatch_factor4",                    NUM,                "1.1000000238418579"    },
	{"dispatch_factor5",                    NUM,                "0.80000001192092896"   },
	{"dispatch_factor6",                    NUM,                "0.69999998807907104"   },
	{"dispatch_factor7",                    NUM,                "1"                     },
	{"dispatch_factor8",                    NUM,                "1"                     },
	{"dispatch_factor9",                    NUM,                "1"                     },
	{"dispatch_sched_weekday",              MAT,                dispatch_sched_weekday, 12,24},
	{"dispatch_sched_weekend",              MAT,                dispatch_sched_weekend, 12,24},
	{"total_installed_cost",                NUM,                "605985600"             },
	{"reserves_interest",                   NUM,                "1.75"                  },
	{"equip1_reserve_cost",                 NUM,                "0"                     },
	{"equip1_reserve_freq",                 NUM,                "12"                    },
	{"equip2_reserve_cost",                 NUM,                "0"                     },
	{"equip2_reserve_freq",                 NUM,                "15"                    },
	{"equip3_reserve_cost",                 NUM,                "0"                     },
	{"equip3_reserve_freq",                 NUM,                "3"                     },
	{"equip_reserve_depr_sta",              NUM,                "0"                     },
	{"equip_reserve_depr_fed",              NUM,                "0"                     },
	{"salvage_percentage",                  NUM,                "0"                     },
	{"ppa_soln_mode",                       NUM,                "0"                     },
	{"ppa_price_input",                     NUM,                "0.12999999523162842"   },
	{"ppa_escalation",                      NUM,                "1"                     },
	{"construction_financing_cost",         NUM,                "30299280"              },
	{"term_tenor",                          NUM,                "18"                    },
	{"term_int_rate",                       NUM,                "7"                     },
	{"dscr",                                NUM,                "1.2999999523162842"    },
	{"dscr_reserve_months",                 NUM,                "6"                     },
	{"debt_percent",                        NUM,                "50"                    },
	{"debt_option",                         NUM,                "1"                     },
	{"payment_option",                      NUM,                "0"                     },
	{"cost_debt_closing",                   NUM,                "450000"                },
	{"cost_debt_fee",                       NUM,                "2.75"                  },
	{"months_working_reserve",              NUM,                "6"                     },
	{"months_receivables_reserve",          NUM,                "0"                     },
	{"cost_other_financing",                NUM,                "0"                     },
	{"flip_target_percent",                 NUM,                "11"                    },
	{"flip_target_year",                    NUM,                "20"                    },
	{"depr_alloc_macrs_5_percent",          NUM,                "90"                    },
	{"depr_alloc_macrs_15_percent",         NUM,                "1.5"                   },
	{"depr_alloc_sl_5_percent",             NUM,                "0"                     },
	{"depr_alloc_sl_15_percent",            NUM,                "2.5"                   },
	{"depr_alloc_sl_20_percent",            NUM,                "3"                     },
	{"depr_alloc_sl_39_percent",            NUM,                "0"                     },
	{"depr_alloc_custom_percent",           NUM,                "0"                     },
	{"depr_custom_schedule",                NUM,                "0"                     },
	{"depr_bonus_sta",                      NUM,                "0"                     },
	{"depr_bonus_sta_macrs_5",              NUM,                "1"                     },
	{"depr_bonus_sta_macrs_15",             NUM,                "1"                     },
	{"depr_bonus_sta_sl_5",                 NUM,                "0"                     },
	{"depr_bonus_sta_sl_15",                NUM,                "0"                     },
	{"depr_bonus_sta_sl_20",                NUM,                "0"                     },
	{"depr_bonus_sta_sl_39",                NUM,                "0"                     },
	{"depr_bonus_sta_custom",               NUM,                "0"                     },
	{"depr_bonus_fed",                      NUM,                "0"                     },
	{"depr_bonus_fed_macrs_5",              NUM,                "1"                     },
	{"depr_bonus_fed_macrs_15",             NUM,                "1"                     },
	{"depr_bonus_fed_sl_5",                 NUM,                "0"                     },
	{"depr_bonus_fed_sl_15",                NUM,                "0"                     },
	{"depr_bonus_fed_sl_20",                NUM,                "0"                     },
	{"depr_bonus_fed_sl_39",                NUM,                "0"                     },
	{"depr_bonus_fed_custom",               NUM,                "0"                     },
	{"depr_itc_sta_macrs_5",                NUM,                "1"                     },
	{"depr_itc_sta_macrs_15",               NUM,                "0"                     },
	{"depr_itc_sta_sl_5",                   NUM,                "0"                     },
	{"depr_itc_sta_sl_15",                  NUM,                "0"                     },
	{"depr_itc_sta_sl_20",                  NUM,                "0"                     },
	{"depr_itc_sta_sl_39",                  NUM,                "0"                     },
	{"depr_itc_sta_custom",                 NUM,                "0"                     },
	{"depr_itc_fed_macrs_5",                NUM,                "1"                     },
	{"depr_itc_fed_macrs_15",               NUM,                "0"                     },
	{"depr_itc_fed_sl_5",                   NUM,                "0"                     },
	{"depr_itc_fed_sl_15",                  NUM,                "0"                     },
	{"depr_itc_fed_sl_20",                  NUM,                "0"                     },
	{"depr_itc_fed_sl_39",                  NUM,                "0"                     },
	{"depr_itc_fed_custom",                 NUM,                "0"                     },
	{"pbi_fed_for_ds",                      NUM,                "0"                     },
	{"pbi_sta_for_ds",                      NUM,                "0"                     },
	{"pbi_uti_for_ds",                      NUM,                "0"                     },
	{"pbi_oth_for_ds",                      NUM,                "0"                     },
	{"depr_stabas_method",                  NUM,                "1"                     },
	{"depr_fedbas_method",                  NUM,                "1"                     }
};

// test_types: equal (EQ), near(approx equal) (NR), greater than (GT), less than (LT), bool (TF), cmod error (ERR)
TestResult physTroughPPASingleDefaultResult[] = {
/*  SSC Var Name                            Test Type           Test Result             Error Bound % */
    { "annual_energy",                      NR,                 355030080.,             0.1 },  // Annual Energy [kWh]
    { "annual_fuel_usage",                  NR,                 0.,                     0.1 },  // Annual fuel usage [kWht]
    { "capacity_factor",                    NR,                 40.5691,                0.1 },  // Capacity factor [%]
    { "annual_q_dump",                      NR,                 48441.5,                0.1 },  // Dumped thermal energy [MWht]
    { "annual_W_cycle_gross",               NR,                 405653.,                0.1 },  // Electrical source - Power cycle gross output [MWhe]
    { "kwh_per_kw",                         NR,                 3553.85,                0.1 },  // First year kWh/kW [kWh/kW]
    { "conversion_factor",                  NR,                 91.17,                  0.1 },  // Gross to Net Conversion Factor [%]
    { "system_heat_rate",                   NR,                 3.413,                  0.1 },  // System heat rate [MMBtu/MWh]
    { "annual_q_to_tes",                    NR,                 7383.12,                0.1 },  // Thermal energy into storage [MWht]
    { "annual_q_pb",                        NR,                 1.12348e06,             0.1 },  // Thermal energy to the power block [MWht]
    { "annual_q_avail",                     NR,                 1.12864e06,             0.1 },  // Thermal power produced by the field [MWht]
    { "annual_total_water_use",             NR,                 80988.9,                0.1 },  // Total Annual Water Usage: cycle + mirror washing [m3]
    { "annual_q_abs_tot",                   NR,                 1.17421e06,             0.1 },  // Total absorbed energy [MWht]
    { "annual_q_aux",                       NR,                 0.,                     0.1 },  // Total fossil fuel usage by all plant subsystems [MMBTU]
    { "annual_q_inc_sf_tot",                NR,                 2.50511e06,             0.1 }   // Total power incident on the field [MWht]
};

testDeclaration defaultTest1(physTroughTesting, "default", &physTroughPPASingleDefaultInfo[0], 383, &physTroughPPASingleDefaultResult[0], 15);



INSTANTIATE_TEST_CASE_P(PhysicalTroughTest, computeModuleTest, testing::ValuesIn(physTroughTests));
